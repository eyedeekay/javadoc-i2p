<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (18) -->
<title>TrustedUpdate (I2P Anonymous Network - Java Documentation - API Version 0.9.55)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: net.i2p.crypto, class: TrustedUpdate">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon"></span><span class="nav-bar-toggle-icon"></span><span class="nav-bar-toggle-icon"></span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/TrustedUpdate.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li><a href="#field-summary">Field</a></li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li><a href="#field-detail">Field</a></li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">net.i2p.crypto</a></div>
<h1 title="Class TrustedUpdate" class="title">Class TrustedUpdate</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">net.i2p.crypto.TrustedUpdate</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">TrustedUpdate</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block"><p>Handles DSA signing and verification of update files.
 </p>
 <p>For convenience this class also makes certain operations available via the
 command line. These can be invoked as follows:
 </p>
 <pre>
 java net.i2p.crypto.TrustedUpdate keygen       <i>publicKeyFile privateKeyFile</i>
 java net.i2p.crypto.TrustedUpdate showversion  <i>signedFile</i>
 java net.i2p.crypto.TrustedUpdate sign         <i>inputFile signedFile privateKeyFile version</i>
 java net.i2p.crypto.TrustedUpdate verifysig    <i>signedFile</i>
 java net.i2p.crypto.TrustedUpdate verifyupdate <i>signedFile</i>
 java net.i2p.crypto.TrustedUpdate verifyversion <i>signedFile</i>
 </pre></div>
<dl class="notes">
<dt>Author:</dt>
<dd>jrandom and smeghead</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static final int</code></div>
<div class="col-second even-row-color"><code><a href="#HEADER_BYTES" class="member-name-link">HEADER_BYTES</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">TrustedUpdate</a>()</code></div>
<div class="col-last even-row-color">
<div class="block">Constructs a new <code>TrustedUpdate</code> with the default global
 context.</div>
</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(net.i2p.I2PAppContext)" class="member-name-link">TrustedUpdate</a><wbr>(<a href="../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;context)</code></div>
<div class="col-last odd-row-color">
<div class="block">Constructs a new <code>TrustedUpdate</code> with the given
 <a href="../I2PAppContext.html" title="class in net.i2p"><code>I2PAppContext</code></a>.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#addKey(java.lang.String,java.lang.String)" class="member-name-link">addKey</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;key,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Duplicate keys or names rejected,
  except that duplicate empty names are allowed</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../data/SigningPublicKey.html" title="class in net.i2p.data">SigningPublicKey</a>,<wbr><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getKeys()" class="member-name-link">getKeys</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getTrustedKeysString()" class="member-name-link">getTrustedKeysString</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Fetches the trusted keys for the current instance.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#getVersionString(java.io.File)" class="member-name-link">getVersionString</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Reads the version string from a signed update file.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#getVersionString(java.io.InputStream)" class="member-name-link">getVersionString</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html" title="class or interface in java.io" class="external-link">InputStream</a>&nbsp;inputStream)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Reads the version string from an input stream</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#haveKey(java.lang.String)" class="member-name-link">haveKey</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;key)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Do we know about the following key?</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isUpdatedVersion(java.lang.String,java.io.File)" class="member-name-link">isUpdatedVersion</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;currentVersion,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verifies that the version of the given signed update file is newer than
 <code>currentVersion</code>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#main(java.lang.String%5B%5D)" class="member-name-link">main</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]&nbsp;args)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Parses command line arguments when this class is used from the command
 line.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#migrateFile(java.io.File,java.io.File)" class="member-name-link">migrateFile</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;outputFile)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Extract the file.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#migrateVerified(java.lang.String,java.io.File,java.io.File)" class="member-name-link">migrateVerified</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;currentVersion,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;outputFile)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verifies the signature of a signed update file, and if it's valid and the
 file's version is newer than the given current version, migrates the data
 out of <code>signedFile</code> and into <code>outputFile</code>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static final boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#needsUpdate(java.lang.String,java.lang.String)" class="member-name-link">needsUpdate</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;currentVersion,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;newVersion)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Checks if the given version is newer than the given current version.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#newVersion()" class="member-name-link">newVersion</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">version in the .sud file, valid only after calling migrateVerified()</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../data/Signature.html" title="class in net.i2p.data">Signature</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#sign(java.lang.String,java.lang.String,java.lang.String,java.lang.String)" class="member-name-link">sign</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;inputFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;signedFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;privateKeyFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;version)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Uses the given private key to sign the given input file along with its
 version string using DSA.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../data/Signature.html" title="class in net.i2p.data">Signature</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#sign(java.lang.String,java.lang.String,net.i2p.data.SigningPrivateKey,java.lang.String)" class="member-name-link">sign</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;inputFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;signedFile,
 <a href="../data/SigningPrivateKey.html" title="class in net.i2p.data">SigningPrivateKey</a>&nbsp;signingPrivateKey,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;version)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Uses the given <a href="../data/SigningPrivateKey.html" title="class in net.i2p.data"><code>SigningPrivateKey</code></a> to sign the given
 input file along with its version string using DSA.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#verify(java.io.File)" class="member-name-link">verify</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verifies the DSA signature of a signed update file.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#verify(java.io.File,net.i2p.data.SigningPublicKey)" class="member-name-link">verify</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile,
 <a href="../data/SigningPublicKey.html" title="class in net.i2p.data">SigningPublicKey</a>&nbsp;signingPublicKey)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verifies the DSA signature of a signed update file.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#verify(java.lang.String,java.lang.String)" class="member-name-link">verify</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;signedFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;publicKeyFile)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verifies the DSA signature of a signed update file.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#verifyAndGetSigner(java.io.File)" class="member-name-link">verifyAndGetSigner</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verifies the DSA signature of a signed update file.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="HEADER_BYTES">
<h3>HEADER_BYTES</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">HEADER_BYTES</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>TrustedUpdate</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">TrustedUpdate</span>()</div>
<div class="block">Constructs a new <code>TrustedUpdate</code> with the default global
 context.</div>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(net.i2p.I2PAppContext)">
<h3>TrustedUpdate</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">TrustedUpdate</span><wbr><span class="parameters">(<a href="../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;context)</span></div>
<div class="block">Constructs a new <code>TrustedUpdate</code> with the given
 <a href="../I2PAppContext.html" title="class in net.i2p"><code>I2PAppContext</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>context</code> - An instance of <code>I2PAppContext</code>.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getKeys()">
<h3>getKeys</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../data/SigningPublicKey.html" title="class in net.i2p.data">SigningPublicKey</a>,<wbr><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</span>&nbsp;<span class="element-name">getKeys</span>()</div>
<dl class="notes">
<dt>Since:</dt>
<dd>0.9.8, public since 0.9.14.1</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="addKey(java.lang.String,java.lang.String)">
<h3>addKey</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">addKey</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;key,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name)</span></div>
<div class="block">Duplicate keys or names rejected,
  except that duplicate empty names are allowed</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - 172 character base64 string</dd>
<dd><code>name</code> - non-null but "" ok</dd>
<dt>Returns:</dt>
<dd>true if successful</dd>
<dt>Since:</dt>
<dd>0.7.12</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="haveKey(java.lang.String)">
<h3>haveKey</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">haveKey</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;key)</span></div>
<div class="block">Do we know about the following key?</div>
<dl class="notes">
<dt>Since:</dt>
<dd>0.7.12</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="main(java.lang.String[])">
<h3>main</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">main</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]&nbsp;args)</span></div>
<div class="block">Parses command line arguments when this class is used from the command
 line.
 Exits 1 on failure so this can be used in scripts.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>args</code> - Command line parameters.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="needsUpdate(java.lang.String,java.lang.String)">
<h3>needsUpdate</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">needsUpdate</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;currentVersion,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;newVersion)</span></div>
<div class="block">Checks if the given version is newer than the given current version.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>currentVersion</code> - The current version.</dd>
<dd><code>newVersion</code> - The version to test.</dd>
<dt>Returns:</dt>
<dd><code>true</code> if the given version is newer than the current
         version, otherwise <code>false</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getTrustedKeysString()">
<h3>getTrustedKeysString</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">getTrustedKeysString</span>()</div>
<div class="block">Fetches the trusted keys for the current instance.
 We could sort it but don't bother.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>A <code>String</code> containing the trusted keys,
 delimited by CR LF line breaks.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getVersionString(java.io.File)">
<h3>getVersionString</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">getVersionString</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile)</span></div>
<div class="block">Reads the version string from a signed update file.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>signedFile</code> - A signed update file.</dd>
<dt>Returns:</dt>
<dd>The version string read, or an empty string if no version string
         is present.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getVersionString(java.io.InputStream)">
<h3>getVersionString</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">getVersionString</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html" title="class or interface in java.io" class="external-link">InputStream</a>&nbsp;inputStream)</span></div>
<div class="block">Reads the version string from an input stream</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>inputStream</code> - containing at least 56 bytes</dd>
<dt>Returns:</dt>
<dd>The version string read, or an empty string if no version string
         is present.</dd>
<dt>Since:</dt>
<dd>0.7.12</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="newVersion()">
<h3>newVersion</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">newVersion</span>()</div>
<div class="block">version in the .sud file, valid only after calling migrateVerified()</div>
</section>
</li>
<li>
<section class="detail" id="isUpdatedVersion(java.lang.String,java.io.File)">
<h3>isUpdatedVersion</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isUpdatedVersion</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;currentVersion,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile)</span></div>
<div class="block">Verifies that the version of the given signed update file is newer than
 <code>currentVersion</code>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>currentVersion</code> - The current version to check against.</dd>
<dd><code>signedFile</code> - The signed update file.</dd>
<dt>Returns:</dt>
<dd><code>true</code> if the signed update file's version is newer
         than the current version, otherwise <code>false</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="migrateVerified(java.lang.String,java.io.File,java.io.File)">
<h3>migrateVerified</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">migrateVerified</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;currentVersion,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;outputFile)</span></div>
<div class="block">Verifies the signature of a signed update file, and if it's valid and the
 file's version is newer than the given current version, migrates the data
 out of <code>signedFile</code> and into <code>outputFile</code>.
 
 As of 0.8.8, the embedded file must be a zip file with
 a standard zip header and a UTF-8 zip file comment
 matching the version in the sud header. This prevents spoofing the version,
 since the sud signature does NOT cover the version in the header.
 (We do this for sud/su2 files but not plugin xpi2p files -
 don't use this method for plugin files)</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>currentVersion</code> - The current version to check against.</dd>
<dd><code>signedFile</code> - A signed update file.</dd>
<dd><code>outputFile</code> - The file to write the verified data to.</dd>
<dt>Returns:</dt>
<dd><code>null</code> if the signature and version were valid and the
         data was moved, and an error <code>String</code> otherwise.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="migrateFile(java.io.File,java.io.File)">
<h3>migrateFile</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">migrateFile</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;outputFile)</span></div>
<div class="block">Extract the file. Skips and ignores the signature and version. No verification.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>signedFile</code> - A signed update file.</dd>
<dd><code>outputFile</code> - The file to write the verified data to.</dd>
<dt>Returns:</dt>
<dd><code>null</code> if the
         data was moved, and an error <code>String</code> otherwise.</dd>
<dt>Since:</dt>
<dd>0.7.12</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="sign(java.lang.String,java.lang.String,java.lang.String,java.lang.String)">
<h3>sign</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../data/Signature.html" title="class in net.i2p.data">Signature</a></span>&nbsp;<span class="element-name">sign</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;inputFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;signedFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;privateKeyFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;version)</span></div>
<div class="block">Uses the given private key to sign the given input file along with its
 version string using DSA. The output will be a signed update file where
 the first 40 bytes are the resulting DSA signature, the next 16 bytes are
 the input file's version string encoded in UTF-8 (padded with trailing
 <code>0h</code> characters if necessary), and the remaining bytes are the
 raw bytes of the input file.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>inputFile</code> - The file to be signed.</dd>
<dd><code>signedFile</code> - The signed update file to write.</dd>
<dd><code>privateKeyFile</code> - The name of the file containing the private key to
                       sign <code>inputFile</code> with.</dd>
<dd><code>version</code> - The version string of the input file. If this is
                       longer than 16 characters it will be truncated.</dd>
<dt>Returns:</dt>
<dd>An instance of <a href="../data/Signature.html" title="class in net.i2p.data"><code>Signature</code></a>, or
         <code>null</code> if there was an error.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="sign(java.lang.String,java.lang.String,net.i2p.data.SigningPrivateKey,java.lang.String)">
<h3>sign</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../data/Signature.html" title="class in net.i2p.data">Signature</a></span>&nbsp;<span class="element-name">sign</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;inputFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;signedFile,
 <a href="../data/SigningPrivateKey.html" title="class in net.i2p.data">SigningPrivateKey</a>&nbsp;signingPrivateKey,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;version)</span></div>
<div class="block">Uses the given <a href="../data/SigningPrivateKey.html" title="class in net.i2p.data"><code>SigningPrivateKey</code></a> to sign the given
 input file along with its version string using DSA. The output will be a
 signed update file where the first 40 bytes are the resulting DSA
 signature, the next 16 bytes are the input file's version string encoded
 in UTF-8 (padded with trailing <code>0h</code> characters if necessary),
 and the remaining bytes are the raw bytes of the input file.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>inputFile</code> - The file to be signed.</dd>
<dd><code>signedFile</code> - The signed update file to write.</dd>
<dd><code>signingPrivateKey</code> - An instance of <code>SigningPrivateKey</code>
                          to sign <code>inputFile</code> with.</dd>
<dd><code>version</code> - The version string of the input file. If this is
                          longer than 16 characters it will be truncated.</dd>
<dt>Returns:</dt>
<dd>An instance of <a href="../data/Signature.html" title="class in net.i2p.data"><code>Signature</code></a>, or
         <code>null</code> if there was an error.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="verify(java.io.File)">
<h3>verify</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">verify</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile)</span></div>
<div class="block">Verifies the DSA signature of a signed update file.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>signedFile</code> - The signed update file to check.</dd>
<dt>Returns:</dt>
<dd><code>true</code> if the file has a valid signature, otherwise
         <code>false</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="verifyAndGetSigner(java.io.File)">
<h3>verifyAndGetSigner</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">verifyAndGetSigner</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile)</span></div>
<div class="block">Verifies the DSA signature of a signed update file.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>signedFile</code> - The signed update file to check.</dd>
<dt>Returns:</dt>
<dd>signer (could be empty string) or null if invalid</dd>
<dt>Since:</dt>
<dd>0.7.12</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="verify(java.lang.String,java.lang.String)">
<h3>verify</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">verify</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;signedFile,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;publicKeyFile)</span></div>
<div class="block">Verifies the DSA signature of a signed update file.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>signedFile</code> - The signed update file to check.</dd>
<dd><code>publicKeyFile</code> - A file containing the public key to use for
                      verification.</dd>
<dt>Returns:</dt>
<dd><code>true</code> if the file has a valid signature, otherwise
         <code>false</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="verify(java.io.File,net.i2p.data.SigningPublicKey)">
<h3>verify</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">verify</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;signedFile,
 <a href="../data/SigningPublicKey.html" title="class in net.i2p.data">SigningPublicKey</a>&nbsp;signingPublicKey)</span></div>
<div class="block">Verifies the DSA signature of a signed update file.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>signedFile</code> - The signed update file to check.</dd>
<dd><code>signingPublicKey</code> - An instance of
                         <a href="../data/SigningPublicKey.html" title="class in net.i2p.data"><code>SigningPublicKey</code></a> to use for
                         verification.</dd>
<dt>Returns:</dt>
<dd><code>true</code> if the file has a valid signature, otherwise
         <code>false</code>.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
