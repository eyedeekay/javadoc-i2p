<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (18) -->
<title>BuildRequestRecord (I2P Anonymous Network - Java Documentation - API Version 0.9.55)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: net.i2p.data.i2np, class: BuildRequestRecord">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon"></span><span class="nav-bar-toggle-icon"></span><span class="nav-bar-toggle-icon"></span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/BuildRequestRecord.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li><a href="#field-summary">Field</a></li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li><a href="#field-detail">Field</a></li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">net.i2p.data.i2np</a></div>
<h1 title="Class BuildRequestRecord" class="title">Class BuildRequestRecord</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">net.i2p.data.i2np.BuildRequestRecord</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">BuildRequestRecord</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">As of 0.9.48, supports two formats.
 As of 0.9.51, supports three formats.
 The original 222-byte ElGamal format, the new 464-byte ECIES format,
 and the newest 154-byte ECIES format.
 See proposal 152 and 157 for details on the new formats.

 None of the readXXX() calls are cached. For efficiency,
 they should only be called once.

 Original ElGamal format:

 Holds the unencrypted 222-byte tunnel request record,
 with a constructor for ElGamal decryption and a method for ElGamal encryption.
 Iterative AES encryption/decryption is done elsewhere.

 Cleartext:
 <pre>
   bytes     0-3: tunnel ID to receive messages as
   bytes    4-35: local router identity hash (Unused and no accessor here)
   bytes   36-39: next tunnel ID
   bytes   40-71: next router identity hash
   bytes  72-103: AES-256 tunnel layer key
   bytes 104-135: AES-256 tunnel IV key
   bytes 136-167: AES-256 reply key
   bytes 168-183: reply IV
   byte      184: flags
   bytes 185-188: request time (in hours since the epoch)
   bytes 189-192: next message ID
   bytes 193-221: uninterpreted / random padding
 </pre>

 Encrypted:
 <pre>
   bytes    0-15: First 16 bytes of router hash
   bytes  16-527: ElGamal encrypted block (discarding zero bytes at elg[0] and elg[257])
 </pre>

 ECIES long record format, ref: proposal 152:

 Holds the unencrypted 464-byte tunnel request record,
 with a constructor for ECIES decryption and a method for ECIES encryption.
 Iterative AES encryption/decryption is done elsewhere.

 Cleartext:
 <pre>
   bytes     0-3: tunnel ID to receive messages as, nonzero
   bytes     4-7: next tunnel ID, nonzero
   bytes    8-39: next router identity hash
   bytes   40-71: AES-256 tunnel layer key
   bytes  72-103: AES-256 tunnel IV key
   bytes 104-135: AES-256 reply key
   bytes 136-151: AES-256 reply IV
   byte      152: flags
   bytes 153-155: more flags, unused, set to 0 for compatibility
   bytes 156-159: request time (in minutes since the epoch, rounded down)
   bytes 160-163: request expiration (in seconds since creation)
   bytes 164-167: next message ID
   bytes   168-x: tunnel build options (Mapping)
   bytes     x-x: other data as implied by flags or options
   bytes   x-463: random padding
 </pre>

 Encrypted:
 <pre>
   bytes    0-15: Hop's truncated identity hash
   bytes   16-47: Sender's ephemeral X25519 public key
   bytes  48-511: ChaCha20 encrypted BuildRequestRecord
   bytes 512-527: Poly1305 MAC
 </pre>

 ECIES short record format, ref: proposal 157:

 Holds the unencrypted 154-byte tunnel request record,
 with a constructor for ECIES decryption and a method for ECIES encryption.
 Iterative AES encryption/decryption is done elsewhere.

 Cleartext:
 <pre>
   bytes     0-3: tunnel ID to receive messages as, nonzero
   bytes     4-7: next tunnel ID, nonzero
   bytes    8-39: next router identity hash
   byte       40: flags
   bytes   41-42: more flags, unused, set to 0 for compatibility
   byte       43: layer enc. type
   bytes   44-47: request time (in minutes since the epoch, rounded down)
   bytes   48-51: request expiration (in seconds since creation)
   bytes   52-55: next message ID
   bytes    56-x: tunnel build options (Mapping)
   bytes     x-x: other data as implied by flags or options
   bytes   x-153: random padding
 </pre>

 Encrypted:
 <pre>
   bytes    0-15: Hop's truncated identity hash
   bytes   16-47: Sender's ephemeral X25519 public key
   bytes  48-201: ChaCha20 encrypted BuildRequestRecord
   bytes 202-217: Poly1305 MAC
 </pre></div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static final int</code></div>
<div class="col-second even-row-color"><code><a href="#IV_SIZE" class="member-name-link">IV_SIZE</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#OFF_REPLY_KEY" class="member-name-link">OFF_REPLY_KEY</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static final int</code></div>
<div class="col-second even-row-color"><code><a href="#OFF_REPLY_KEY_EC" class="member-name-link">OFF_REPLY_KEY_EC</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#PEER_SIZE" class="member-name-link">PEER_SIZE</a></code></div>
<div class="col-last odd-row-color">
<div class="block">we show 16 bytes of the peer hash outside the elGamal block</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(net.i2p.I2PAppContext,long,long,net.i2p.data.Hash,long,boolean,boolean,java.util.Properties)" class="member-name-link">BuildRequestRecord</a><wbr>(<a href="../../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx,
 long&nbsp;receiveTunnelId,
 long&nbsp;nextTunnelId,
 <a href="../Hash.html" title="class in net.i2p.data">Hash</a>&nbsp;nextHop,
 long&nbsp;nextMsgId,
 boolean&nbsp;isInGateway,
 boolean&nbsp;isOutEndpoint,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Properties.html" title="class or interface in java.util" class="external-link">Properties</a>&nbsp;options)</code></div>
<div class="col-last even-row-color">
<div class="block">Populate this instance with data.</div>
</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(net.i2p.I2PAppContext,long,long,net.i2p.data.Hash,long,net.i2p.data.SessionKey,net.i2p.data.SessionKey,net.i2p.data.SessionKey,byte%5B%5D,boolean,boolean,java.util.Properties)" class="member-name-link">BuildRequestRecord</a><wbr>(<a href="../../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx,
 long&nbsp;receiveTunnelId,
 long&nbsp;nextTunnelId,
 <a href="../Hash.html" title="class in net.i2p.data">Hash</a>&nbsp;nextHop,
 long&nbsp;nextMsgId,
 <a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;layerKey,
 <a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;ivKey,
 <a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;replyKey,
 byte[]&nbsp;iv,
 boolean&nbsp;isInGateway,
 boolean&nbsp;isOutEndpoint,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Properties.html" title="class or interface in java.util" class="external-link">Properties</a>&nbsp;options)</code></div>
<div class="col-last odd-row-color">
<div class="block">Populate this instance with data.</div>
</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(net.i2p.I2PAppContext,long,net.i2p.data.Hash,long,net.i2p.data.Hash,long,net.i2p.data.SessionKey,net.i2p.data.SessionKey,net.i2p.data.SessionKey,byte%5B%5D,boolean,boolean)" class="member-name-link">BuildRequestRecord</a><wbr>(<a href="../../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx,
 long&nbsp;receiveTunnelId,
 <a href="../Hash.html" title="class in net.i2p.data">Hash</a>&nbsp;peer,
 long&nbsp;nextTunnelId,
 <a href="../Hash.html" title="class in net.i2p.data">Hash</a>&nbsp;nextHop,
 long&nbsp;nextMsgId,
 <a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;layerKey,
 <a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;ivKey,
 <a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;replyKey,
 byte[]&nbsp;iv,
 boolean&nbsp;isInGateway,
 boolean&nbsp;isOutEndpoint)</code></div>
<div class="col-last even-row-color">
<div class="block">Populate this instance with data.</div>
</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(net.i2p.router.RouterContext,net.i2p.data.PrivateKey,net.i2p.data.i2np.EncryptedBuildRecord)" class="member-name-link">BuildRequestRecord</a><wbr>(<a href="../../router/RouterContext.html" title="class in net.i2p.router">RouterContext</a>&nbsp;ctx,
 <a href="../PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;ourKey,
 <a href="EncryptedBuildRecord.html" title="class in net.i2p.data.i2np">EncryptedBuildRecord</a>&nbsp;encryptedRecord)</code></div>
<div class="col-last odd-row-color">
<div class="block">Decrypt the data from the specified record, writing the decrypted record into this instance's
 data buffer

 Caller MUST check that first 16 bytes of our hash matches first 16 bytes of encryptedRecord
 before calling this.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="EncryptedBuildRecord.html" title="class in net.i2p.data.i2np">EncryptedBuildRecord</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#encryptECIESRecord(net.i2p.router.RouterContext,net.i2p.data.PublicKey,net.i2p.data.Hash)" class="member-name-link">encryptECIESRecord</a><wbr>(<a href="../../router/RouterContext.html" title="class in net.i2p.router">RouterContext</a>&nbsp;ctx,
 <a href="../PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;toKey,
 <a href="../Hash.html" title="class in net.i2p.data">Hash</a>&nbsp;toPeer)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Encrypt the record to the specified peer.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="EncryptedBuildRecord.html" title="class in net.i2p.data.i2np">EncryptedBuildRecord</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#encryptRecord(net.i2p.I2PAppContext,net.i2p.data.PublicKey,net.i2p.data.Hash)" class="member-name-link">encryptRecord</a><wbr>(<a href="../../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx,
 <a href="../PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;toKey,
 <a href="../Hash.html" title="class in net.i2p.data">Hash</a>&nbsp;toPeer)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Encrypt the record to the specified peer.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getChaChaReplyAD()" class="member-name-link">getChaChaReplyAD</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Valid after calling encryptECIESRecord() or after the decrypting constructor
 with an ECIES private key.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getChaChaReplyKey()" class="member-name-link">getChaChaReplyKey</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Valid after calling encryptECIESRecord() or after the decrypting constructor
 with an ECIES private key.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getData()" class="member-name-link">getData</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readExpiration()" class="member-name-link">readExpiration</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The expiration in milliseconds from now.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../../router/networkdb/kademlia/MessageWrapper.OneTimeSession.html" title="class in net.i2p.router.networkdb.kademlia">MessageWrapper.OneTimeSession</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readGarlicKeys()" class="member-name-link">readGarlicKeys</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">ECIES short OBEP record only.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readIsInboundGateway()" class="member-name-link">readIsInboundGateway</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The current hop is the inbound gateway.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readIsOutboundEndpoint()" class="member-name-link">readIsOutboundEndpoint</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The current hop is the outbound endpoint.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readIVKey()" class="member-name-link">readIVKey</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Tunnel IV encryption key that the current hop should use</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readLayerEncryptionType()" class="member-name-link">readLayerEncryptionType</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">ECIES short record only.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readLayerKey()" class="member-name-link">readLayerKey</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Tunnel layer encryption key that the current hop should use</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../Hash.html" title="class in net.i2p.data">Hash</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readNextIdentity()" class="member-name-link">readNextIdentity</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Read the next hop from the record.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readNextTunnelId()" class="member-name-link">readNextTunnelId</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">What tunnel ID the next hop receives messages on.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Properties.html" title="class or interface in java.util" class="external-link">Properties</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readOptions()" class="member-name-link">readOptions</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">ECIES only.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readReceiveTunnelId()" class="member-name-link">readReceiveTunnelId</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">what tunnel ID should this receive messages on</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readReplyIV()" class="member-name-link">readReplyIV</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">AES IV that should be used to encrypt the reply.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readReplyKey()" class="member-name-link">readReplyKey</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">AES Session key that should be used to encrypt the reply.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readReplyMessageId()" class="member-name-link">readReplyMessageId</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">What message ID should we send the request to the next hop with.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#readRequestTime()" class="member-name-link">readRequestTime</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">For ElGamal, time that the request was sent (ms), truncated to the nearest hour.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toString()" class="member-name-link">toString</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="IV_SIZE">
<h3>IV_SIZE</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">IV_SIZE</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../constant-values.html#net.i2p.data.i2np.BuildRequestRecord.IV_SIZE">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="PEER_SIZE">
<h3>PEER_SIZE</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">PEER_SIZE</span></div>
<div class="block">we show 16 bytes of the peer hash outside the elGamal block</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../constant-values.html#net.i2p.data.i2np.BuildRequestRecord.PEER_SIZE">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="OFF_REPLY_KEY">
<h3>OFF_REPLY_KEY</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">OFF_REPLY_KEY</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../constant-values.html#net.i2p.data.i2np.BuildRequestRecord.OFF_REPLY_KEY">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="OFF_REPLY_KEY_EC">
<h3>OFF_REPLY_KEY_EC</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">OFF_REPLY_KEY_EC</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../constant-values.html#net.i2p.data.i2np.BuildRequestRecord.OFF_REPLY_KEY_EC">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(net.i2p.router.RouterContext,net.i2p.data.PrivateKey,net.i2p.data.i2np.EncryptedBuildRecord)">
<h3>BuildRequestRecord</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">BuildRequestRecord</span><wbr><span class="parameters">(<a href="../../router/RouterContext.html" title="class in net.i2p.router">RouterContext</a>&nbsp;ctx,
 <a href="../PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;ourKey,
 <a href="EncryptedBuildRecord.html" title="class in net.i2p.data.i2np">EncryptedBuildRecord</a>&nbsp;encryptedRecord)</span>
                   throws <span class="exceptions"><a href="../DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></span></div>
<div class="block">Decrypt the data from the specified record, writing the decrypted record into this instance's
 data buffer

 Caller MUST check that first 16 bytes of our hash matches first 16 bytes of encryptedRecord
 before calling this. Not checked here.

 The ChaCha reply key and IV will be available via the getters
 after this call if ourKey is ECIES.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="../DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code> - on decrypt fail</dd>
<dt>Since:</dt>
<dd>0.9.48</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(net.i2p.I2PAppContext,long,net.i2p.data.Hash,long,net.i2p.data.Hash,long,net.i2p.data.SessionKey,net.i2p.data.SessionKey,net.i2p.data.SessionKey,byte[],boolean,boolean)">
<h3>BuildRequestRecord</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">BuildRequestRecord</span><wbr><span class="parameters">(<a href="../../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx,
 long&nbsp;receiveTunnelId,
 <a href="../Hash.html" title="class in net.i2p.data">Hash</a>&nbsp;peer,
 long&nbsp;nextTunnelId,
 <a href="../Hash.html" title="class in net.i2p.data">Hash</a>&nbsp;nextHop,
 long&nbsp;nextMsgId,
 <a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;layerKey,
 <a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;ivKey,
 <a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;replyKey,
 byte[]&nbsp;iv,
 boolean&nbsp;isInGateway,
 boolean&nbsp;isOutEndpoint)</span></div>
<div class="block">Populate this instance with data.  A new buffer is created to contain the data, with the 
 necessary randomized padding.

 ElGamal only. ECIES constructor below.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>receiveTunnelId</code> - tunnel the current hop will receive messages on</dd>
<dd><code>peer</code> - current hop's identity, unused, no read() method</dd>
<dd><code>nextTunnelId</code> - id for the next hop, or where we send the reply (if we are the outbound endpoint)</dd>
<dd><code>nextHop</code> - next hop's identity, or where we send the reply (if we are the outbound endpoint)</dd>
<dd><code>nextMsgId</code> - message ID to use when sending on to the next hop (or for the reply)</dd>
<dd><code>layerKey</code> - tunnel layer key to be used by the peer</dd>
<dd><code>ivKey</code> - tunnel IV key to be used by the peer</dd>
<dd><code>replyKey</code> - key to be used when encrypting the reply to this build request</dd>
<dd><code>iv</code> - iv to be used when encrypting the reply to this build request</dd>
<dd><code>isInGateway</code> - are we the gateway of an inbound tunnel?</dd>
<dd><code>isOutEndpoint</code> - are we the endpoint of an outbound tunnel?</dd>
<dt>Since:</dt>
<dd>0.9.18, was createRecord()</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(net.i2p.I2PAppContext,long,long,net.i2p.data.Hash,long,net.i2p.data.SessionKey,net.i2p.data.SessionKey,net.i2p.data.SessionKey,byte[],boolean,boolean,java.util.Properties)">
<h3>BuildRequestRecord</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">BuildRequestRecord</span><wbr><span class="parameters">(<a href="../../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx,
 long&nbsp;receiveTunnelId,
 long&nbsp;nextTunnelId,
 <a href="../Hash.html" title="class in net.i2p.data">Hash</a>&nbsp;nextHop,
 long&nbsp;nextMsgId,
 <a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;layerKey,
 <a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;ivKey,
 <a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;replyKey,
 byte[]&nbsp;iv,
 boolean&nbsp;isInGateway,
 boolean&nbsp;isOutEndpoint,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Properties.html" title="class or interface in java.util" class="external-link">Properties</a>&nbsp;options)</span></div>
<div class="block">Populate this instance with data.  A new buffer is created to contain the data, with the 
 necessary randomized padding.

 ECIES long record only. ElGamal constructor above.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>receiveTunnelId</code> - tunnel the current hop will receive messages on</dd>
<dd><code>nextTunnelId</code> - id for the next hop, or where we send the reply (if we are the outbound endpoint)</dd>
<dd><code>nextHop</code> - next hop's identity, or where we send the reply (if we are the outbound endpoint)</dd>
<dd><code>nextMsgId</code> - message ID to use when sending on to the next hop (or for the reply)</dd>
<dd><code>layerKey</code> - tunnel layer key to be used by the peer</dd>
<dd><code>ivKey</code> - tunnel IV key to be used by the peer</dd>
<dd><code>replyKey</code> - key to be used when encrypting the reply to this build request</dd>
<dd><code>iv</code> - iv to be used when encrypting the reply to this build request</dd>
<dd><code>isInGateway</code> - are we the gateway of an inbound tunnel?</dd>
<dd><code>isOutEndpoint</code> - are we the endpoint of an outbound tunnel?</dd>
<dd><code>options</code> - 296 bytes max when serialized</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if options too long</dd>
<dt>Since:</dt>
<dd>0.9.48</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(net.i2p.I2PAppContext,long,long,net.i2p.data.Hash,long,boolean,boolean,java.util.Properties)">
<h3>BuildRequestRecord</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">BuildRequestRecord</span><wbr><span class="parameters">(<a href="../../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx,
 long&nbsp;receiveTunnelId,
 long&nbsp;nextTunnelId,
 <a href="../Hash.html" title="class in net.i2p.data">Hash</a>&nbsp;nextHop,
 long&nbsp;nextMsgId,
 boolean&nbsp;isInGateway,
 boolean&nbsp;isOutEndpoint,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Properties.html" title="class or interface in java.util" class="external-link">Properties</a>&nbsp;options)</span></div>
<div class="block">Populate this instance with data.  A new buffer is created to contain the data, with the 
 necessary randomized padding.

 ECIES short record only. ElGamal constructor above.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>receiveTunnelId</code> - tunnel the current hop will receive messages on</dd>
<dd><code>nextTunnelId</code> - id for the next hop, or where we send the reply (if we are the outbound endpoint)</dd>
<dd><code>nextHop</code> - next hop's identity, or where we send the reply (if we are the outbound endpoint)</dd>
<dd><code>nextMsgId</code> - message ID to use when sending on to the next hop (or for the reply)</dd>
<dd><code>isInGateway</code> - are we the gateway of an inbound tunnel?</dd>
<dd><code>isOutEndpoint</code> - are we the endpoint of an outbound tunnel?</dd>
<dd><code>options</code> - 98 bytes max when serialized</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if options too long</dd>
<dt>Since:</dt>
<dd>0.9.51</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getData()">
<h3>getData</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">getData</span>()</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>222 (ElG) or 464 (ECIES) bytes, non-null</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="readReceiveTunnelId()">
<h3>readReceiveTunnelId</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">readReceiveTunnelId</span>()</div>
<div class="block">what tunnel ID should this receive messages on</div>
</section>
</li>
<li>
<section class="detail" id="readNextTunnelId()">
<h3>readNextTunnelId</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">readNextTunnelId</span>()</div>
<div class="block">What tunnel ID the next hop receives messages on.  If this is the outbound tunnel endpoint,
 this specifies the tunnel ID to which the reply should be sent.</div>
</section>
</li>
<li>
<section class="detail" id="readNextIdentity()">
<h3>readNextIdentity</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../Hash.html" title="class in net.i2p.data">Hash</a></span>&nbsp;<span class="element-name">readNextIdentity</span>()</div>
<div class="block">Read the next hop from the record.  If this is the outbound tunnel endpoint, this specifies
 the gateway to which the reply should be sent.</div>
</section>
</li>
<li>
<section class="detail" id="readLayerKey()">
<h3>readLayerKey</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a></span>&nbsp;<span class="element-name">readLayerKey</span>()</div>
<div class="block">Tunnel layer encryption key that the current hop should use</div>
</section>
</li>
<li>
<section class="detail" id="readIVKey()">
<h3>readIVKey</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a></span>&nbsp;<span class="element-name">readIVKey</span>()</div>
<div class="block">Tunnel IV encryption key that the current hop should use</div>
</section>
</li>
<li>
<section class="detail" id="readReplyKey()">
<h3>readReplyKey</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a></span>&nbsp;<span class="element-name">readReplyKey</span>()</div>
<div class="block">AES Session key that should be used to encrypt the reply.
 Not to be used for short ECIES records; use the ChaChaReplyKey instead.</div>
</section>
</li>
<li>
<section class="detail" id="readReplyIV()">
<h3>readReplyIV</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">readReplyIV</span>()</div>
<div class="block">AES IV that should be used to encrypt the reply.
 Not to be used for short ECIES records.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>16 bytes</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="readIsInboundGateway()">
<h3>readIsInboundGateway</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">readIsInboundGateway</span>()</div>
<div class="block">The current hop is the inbound gateway.  If this is true, it means anyone can send messages to
 this tunnel, but if it is false, only the current predecessor can.</div>
</section>
</li>
<li>
<section class="detail" id="readIsOutboundEndpoint()">
<h3>readIsOutboundEndpoint</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">readIsOutboundEndpoint</span>()</div>
<div class="block">The current hop is the outbound endpoint.  If this is true, the next identity and next tunnel
 fields refer to where the reply should be sent.</div>
</section>
</li>
<li>
<section class="detail" id="readRequestTime()">
<h3>readRequestTime</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">readRequestTime</span>()</div>
<div class="block">For ElGamal, time that the request was sent (ms), truncated to the nearest hour.
 For ECIES, time that the request was sent (ms), truncated to the nearest minute.
 This ignores leap seconds.</div>
</section>
</li>
<li>
<section class="detail" id="readReplyMessageId()">
<h3>readReplyMessageId</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">readReplyMessageId</span>()</div>
<div class="block">What message ID should we send the request to the next hop with.  If this is the outbound tunnel endpoint,
 this specifies the message ID with which the reply should be sent.</div>
</section>
</li>
<li>
<section class="detail" id="readExpiration()">
<h3>readExpiration</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">readExpiration</span>()</div>
<div class="block">The expiration in milliseconds from now.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>0.9.48</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="readOptions()">
<h3>readOptions</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Properties.html" title="class or interface in java.util" class="external-link">Properties</a></span>&nbsp;<span class="element-name">readOptions</span>()</div>
<div class="block">ECIES only.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>null for ElGamal or on error</dd>
<dt>Since:</dt>
<dd>0.9.48</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="readLayerEncryptionType()">
<h3>readLayerEncryptionType</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">readLayerEncryptionType</span>()</div>
<div class="block">ECIES short record only.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>0 for ElGamal or ECIES long record</dd>
<dt>Since:</dt>
<dd>0.9.51</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="readGarlicKeys()">
<h3>readGarlicKeys</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../../router/networkdb/kademlia/MessageWrapper.OneTimeSession.html" title="class in net.i2p.router.networkdb.kademlia">MessageWrapper.OneTimeSession</a></span>&nbsp;<span class="element-name">readGarlicKeys</span>()</div>
<div class="block">ECIES short OBEP record only.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>null for ElGamal or ECIES long record or non-OBEP</dd>
<dt>Since:</dt>
<dd>0.9.51</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="encryptRecord(net.i2p.I2PAppContext,net.i2p.data.PublicKey,net.i2p.data.Hash)">
<h3>encryptRecord</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="EncryptedBuildRecord.html" title="class in net.i2p.data.i2np">EncryptedBuildRecord</a></span>&nbsp;<span class="element-name">encryptRecord</span><wbr><span class="parameters">(<a href="../../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx,
 <a href="../PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;toKey,
 <a href="../Hash.html" title="class in net.i2p.data">Hash</a>&nbsp;toPeer)</span></div>
<div class="block">Encrypt the record to the specified peer.  The result is formatted as: <pre>
   bytes 0-15: truncated SHA-256 of the current hop's identity (the toPeer parameter)
 bytes 15-527: ElGamal-2048 encrypted block
 </pre>

 ElGamal only</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>non-null</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="encryptECIESRecord(net.i2p.router.RouterContext,net.i2p.data.PublicKey,net.i2p.data.Hash)">
<h3>encryptECIESRecord</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="EncryptedBuildRecord.html" title="class in net.i2p.data.i2np">EncryptedBuildRecord</a></span>&nbsp;<span class="element-name">encryptECIESRecord</span><wbr><span class="parameters">(<a href="../../router/RouterContext.html" title="class in net.i2p.router">RouterContext</a>&nbsp;ctx,
 <a href="../PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;toKey,
 <a href="../Hash.html" title="class in net.i2p.data">Hash</a>&nbsp;toPeer)</span></div>
<div class="block">Encrypt the record to the specified peer. ECIES only.
 The ChaCha reply key and IV will be available via the getters
 after this call.
 For short records, derived keys will be available via
 readLayerKey(), readIVKey(), and readGarlicKeys() after this call.
 See class javadocs for format.
 See proposals 152 and 157.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>non-null</dd>
<dt>Since:</dt>
<dd>0.9.48</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getChaChaReplyKey()">
<h3>getChaChaReplyKey</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../SessionKey.html" title="class in net.i2p.data">SessionKey</a></span>&nbsp;<span class="element-name">getChaChaReplyKey</span>()</div>
<div class="block">Valid after calling encryptECIESRecord() or after the decrypting constructor
 with an ECIES private key.
 See proposal 152.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>null if no ECIES encrypt/decrypt operation was performed</dd>
<dt>Since:</dt>
<dd>0.9.48</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getChaChaReplyAD()">
<h3>getChaChaReplyAD</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">getChaChaReplyAD</span>()</div>
<div class="block">Valid after calling encryptECIESRecord() or after the decrypting constructor
 with an ECIES private key.
 See proposal 152.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>null if no ECIES encrypt/decrypt operation was performed</dd>
<dt>Since:</dt>
<dd>0.9.48</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toString()">
<h3>toString</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">toString</span>()</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></dd>
<dt>Since:</dt>
<dd>0.9.24</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
