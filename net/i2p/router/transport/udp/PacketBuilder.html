<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>PacketBuilder (I2P Anonymous Network - Java Documentation - Version 1.6.1)</title>
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PacketBuilder (I2P Anonymous Network - Java Documentation - Version 1.6.1)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":10,"i21":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PacketBuilder.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../net/i2p/router/transport/udp/OutboundRefiller.html" title="class in net.i2p.router.transport.udp"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.Fragment.html" title="class in net.i2p.router.transport.udp"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?net/i2p/router/transport/udp/PacketBuilder.html" target="_top">Frames</a></li>
<li><a href="PacketBuilder.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">net.i2p.router.transport.udp</div>
<h2 title="Class PacketBuilder" class="title">Class PacketBuilder</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>net.i2p.router.transport.udp.PacketBuilder</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>class <span class="typeNameLabel">PacketBuilder</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">Big ol' class to do all our packet formatting.  The UDPPackets generated are
 fully authenticated, encrypted, and configured for delivery to the peer. 

 The following is from udp.html on the website:

<p>
All UDP datagrams begin with a 16 byte MAC (Message Authentication Code)
and a 16 byte IV (Initialization Vector
followed by a variable
size payload encrypted with the appropriate key.  The MAC used is 
HMAC-MD5, truncated to 16 bytes, while the key is a full 32 byte AES256 
key.  The specific construct of the MAC is the first 16 bytes from:</p>
<pre>
  HMAC-MD5(payload || IV || (payloadLength ^ protocolVersion), macKey)
</pre>

<p>The protocol version is currently 0.</p>

<p>The payload itself is AES256/CBC encrypted with the IV and the 
sessionKey, with replay prevention addressed within its body, 
explained below.  The payloadLength in the MAC is a 2 byte unsigned 
integer in 2s complement.</p>
  
<p>The protocolVersion is a 2 byte unsigned integer in 2s complement,
and currently set to 0.  Peers using a different protocol version will
not be able to communicate with this peer, though earlier versions not
using this flag are.</p>

<h2 id="payload">Payload</h2>

<p>Within the AES encrypted payload, there is a minimal common structure
to the various messages - a one byte flag and a four byte sending 
timestamp (*seconds* since the unix epoch).  The flag byte contains 
the following bitfields:</p>
<pre>
Bit order: 76543210
  bits 7-4: payload type
     bit 3: rekey?
     bit 2: extended options included
  bits 1-0: reserved
</pre>

<p>If the rekey flag is set, 64 bytes of keying material follow the 
timestamp.  If the extended options flag is set, a one byte option 
size value is appended to, followed by that many extended option 
bytes, which are currently uninterpreted.</p>

<p>When rekeying, the first 32 bytes of the keying material is fed 
into a SHA256 to produce the new MAC key, and the next 32 bytes are
fed into a SHA256 to produce the new session key, though the keys are
not immediately used.  The other side should also reply with the 
rekey flag set and that same keying material.  Once both sides have 
sent and received those values, the new keys should be used and the 
previous keys discarded.  It may be useful to keep the old keys 
around briefly, to address packet loss and reordering.</p>

<p>NOTE: Rekeying is currently unimplemented.</p>

<pre>
 Header: 37+ bytes
 +----+----+----+----+----+----+----+----+
 |                  MAC                  |
 |                                       |
 +----+----+----+----+----+----+----+----+
 |                   IV                  |
 |                                       |
 +----+----+----+----+----+----+----+----+
 |flag|        time       | (optionally  |
 +----+----+----+----+----+              |
 | this may have 64 byte keying material |
 | and/or a one+N byte extended options) |
 +---------------------------------------|
</pre></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.Fragment.html" title="class in net.i2p.router.transport.udp">PacketBuilder.Fragment</a></span></code>
<div class="block">Class for passing multiple fragments to buildPacket()</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#ABSOLUTE_MAX_ACKS">ABSOLUTE_MAX_ACKS</a></span></code>
<div class="block">one byte field</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#DATA_HEADER_SIZE">DATA_HEADER_SIZE</a></span></code>
<div class="block">not including acks.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#FRAGMENT_HEADER_SIZE">FRAGMENT_HEADER_SIZE</a></span></code>
<div class="block">4 byte msg ID + 3 byte fragment info</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#HEADER_SIZE">HEADER_SIZE</a></span></code>
<div class="block">if no extended options or rekey data, which we don't support  = 37</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#IP_HEADER_SIZE">IP_HEADER_SIZE</a></span></code>
<div class="block">IPv4 only</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#IPV6_HEADER_SIZE">IPV6_HEADER_SIZE</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#MIN_DATA_PACKET_OVERHEAD">MIN_DATA_PACKET_OVERHEAD</a></span></code>
<div class="block">74</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#MIN_IPV6_DATA_PACKET_OVERHEAD">MIN_IPV6_DATA_PACKET_OVERHEAD</a></span></code>
<div class="block">94</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_ACK">TYPE_ACK</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_CONF">TYPE_CONF</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_CREAT">TYPE_CREAT</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_FIRST">TYPE_FIRST</a></span></code>
<div class="block">For debugging and stats only - does not go out on the wire.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_INTRO">TYPE_INTRO</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_PUNCH">TYPE_PUNCH</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_RESP">TYPE_RESP</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_RREQ">TYPE_RREQ</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_SREQ">TYPE_SREQ</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_TBC">TYPE_TBC</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_TCB">TYPE_TCB</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_TFA">TYPE_TFA</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#TYPE_TTA">TYPE_TTA</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#UDP_HEADER_SIZE">UDP_HEADER_SIZE</a></span></code>
<div class="block">Same for IPv4 and IPv6</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#PacketBuilder-net.i2p.router.RouterContext-net.i2p.router.transport.udp.UDPTransport-">PacketBuilder</a></span>(<a href="../../../../../net/i2p/router/RouterContext.html" title="class in net.i2p.router">RouterContext</a>&nbsp;ctx,
             <a href="../../../../../net/i2p/router/transport/udp/UDPTransport.html" title="class in net.i2p.router.transport.udp">UDPTransport</a>&nbsp;transport)</code>
<div class="block">No state, all methods are thread-safe.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildACK-net.i2p.router.transport.udp.PeerState-java.util.List-">buildACK</a></span>(<a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
        <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../net/i2p/router/transport/udp/ACKBitfield.html" title="interface in net.i2p.router.transport.udp">ACKBitfield</a>&gt;&nbsp;ackBitfields)</code>
<div class="block">Build the ack packet.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildHolePunch-java.net.InetAddress-int-">buildHolePunch</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;to,
              int&nbsp;port)</code>
<div class="block">Creates an empty unauthenticated packet for hole punching.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildPacket-byte:A-java.net.InetAddress-int-">buildPacket</a></span>(byte[]&nbsp;data,
           <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;to,
           int&nbsp;port)</code>
<div class="block">TESTING ONLY.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildPacket-java.util.List-net.i2p.router.transport.udp.PeerState-java.util.Collection-int-java.util.List-">buildPacket</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.Fragment.html" title="class in net.i2p.router.transport.udp">PacketBuilder.Fragment</a>&gt;&nbsp;fragments,
           <a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
           <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&gt;&nbsp;ackIdsRemaining,
           int&nbsp;newAckCount,
           <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../net/i2p/router/transport/udp/ACKBitfield.html" title="interface in net.i2p.router.transport.udp">ACKBitfield</a>&gt;&nbsp;partialACKsRemaining)</code>&nbsp;</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildPacket-net.i2p.router.transport.udp.OutboundMessageState-int-net.i2p.router.transport.udp.PeerState-java.util.Collection-int-java.util.List-">buildPacket</a></span>(<a href="../../../../../net/i2p/router/transport/udp/OutboundMessageState.html" title="class in net.i2p.router.transport.udp">OutboundMessageState</a>&nbsp;state,
           int&nbsp;fragment,
           <a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
           <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&gt;&nbsp;ackIdsRemaining,
           int&nbsp;newAckCount,
           <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../net/i2p/router/transport/udp/ACKBitfield.html" title="interface in net.i2p.router.transport.udp">ACKBitfield</a>&gt;&nbsp;partialACKsRemaining)</code>
<div class="block">This builds a data packet (PAYLOAD_TYPE_DATA).</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildPeerTestFromAlice-java.net.InetAddress-int-net.i2p.data.SessionKey-long-net.i2p.data.SessionKey-">buildPeerTestFromAlice</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;toIP,
                      int&nbsp;toPort,
                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;toIntroKey,
                      long&nbsp;nonce,
                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey)</code>
<div class="block">Build a packet as if we are Alice and we either want Bob to begin a 
 peer test or Charlie to finish a peer test.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildPeerTestFromAlice-java.net.InetAddress-int-net.i2p.data.SessionKey-net.i2p.data.SessionKey-long-net.i2p.data.SessionKey-">buildPeerTestFromAlice</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;toIP,
                      int&nbsp;toPort,
                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;toCipherKey,
                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;toMACKey,
                      long&nbsp;nonce,
                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey)</code>
<div class="block">Build a packet as if we are Alice and we either want Bob to begin a 
 peer test or Charlie to finish a peer test.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildPeerTestToAlice-java.net.InetAddress-int-net.i2p.data.SessionKey-net.i2p.data.SessionKey-long-">buildPeerTestToAlice</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;aliceIP,
                    int&nbsp;alicePort,
                    <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey,
                    <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieIntroKey,
                    long&nbsp;nonce)</code>
<div class="block">Build a packet as if we are either Bob or Charlie and we are helping test Alice.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildPeerTestToAlice-java.net.InetAddress-int-net.i2p.data.SessionKey-net.i2p.data.SessionKey-net.i2p.data.SessionKey-long-">buildPeerTestToAlice</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;aliceIP,
                    int&nbsp;alicePort,
                    <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceCipherKey,
                    <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceMACKey,
                    <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieIntroKey,
                    long&nbsp;nonce)</code>
<div class="block">Build a packet as if we are either Bob or Charlie and we are helping test Alice.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildPeerTestToBob-java.net.InetAddress-int-java.net.InetAddress-int-net.i2p.data.SessionKey-long-net.i2p.data.SessionKey-net.i2p.data.SessionKey-">buildPeerTestToBob</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;bobIP,
                  int&nbsp;bobPort,
                  <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;aliceIP,
                  int&nbsp;alicePort,
                  <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey,
                  long&nbsp;nonce,
                  <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;bobCipherKey,
                  <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;bobMACKey)</code>
<div class="block">Build a packet as if we are Charlie sending Bob a packet verifying that we will help test Alice.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildPeerTestToCharlie-java.net.InetAddress-int-net.i2p.data.SessionKey-long-java.net.InetAddress-int-net.i2p.data.SessionKey-net.i2p.data.SessionKey-">buildPeerTestToCharlie</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;aliceIP,
                      int&nbsp;alicePort,
                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey,
                      long&nbsp;nonce,
                      <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;charlieIP,
                      int&nbsp;charliePort,
                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieCipherKey,
                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieMACKey)</code>
<div class="block">Build a packet as if we are Bob sending Charlie a packet to help test Alice.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildPing-net.i2p.router.transport.udp.PeerState-">buildPing</a></span>(<a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer)</code>
<div class="block">An ACK packet with no acks.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>(package private) <a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildRelayIntro-net.i2p.router.transport.udp.RemoteHostId-net.i2p.router.transport.udp.PeerState-net.i2p.router.transport.udp.UDPPacketReader.RelayRequestReader-">buildRelayIntro</a></span>(<a href="../../../../../net/i2p/router/transport/udp/RemoteHostId.html" title="class in net.i2p.router.transport.udp">RemoteHostId</a>&nbsp;alice,
               <a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;charlie,
               <a href="../../../../../net/i2p/router/transport/udp/UDPPacketReader.RelayRequestReader.html" title="class in net.i2p.router.transport.udp">UDPPacketReader.RelayRequestReader</a>&nbsp;request)</code>&nbsp;</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildRelayRequest-net.i2p.router.transport.udp.UDPTransport-net.i2p.router.transport.udp.EstablishmentManager-net.i2p.router.transport.udp.OutboundEstablishState-net.i2p.data.SessionKey-">buildRelayRequest</a></span>(<a href="../../../../../net/i2p/router/transport/udp/UDPTransport.html" title="class in net.i2p.router.transport.udp">UDPTransport</a>&nbsp;transport,
                 <a href="../../../../../net/i2p/router/transport/udp/EstablishmentManager.html" title="class in net.i2p.router.transport.udp">EstablishmentManager</a>&nbsp;emgr,
                 <a href="../../../../../net/i2p/router/transport/udp/OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;state,
                 <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;ourIntroKey)</code>
<div class="block">build intro packets for each of the published introducers</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>(package private) <a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildRelayResponse-net.i2p.router.transport.udp.RemoteHostId-net.i2p.router.transport.udp.PeerState-long-net.i2p.data.SessionKey-net.i2p.data.SessionKey-">buildRelayResponse</a></span>(<a href="../../../../../net/i2p/router/transport/udp/RemoteHostId.html" title="class in net.i2p.router.transport.udp">RemoteHostId</a>&nbsp;alice,
                  <a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;charlie,
                  long&nbsp;nonce,
                  <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;cipherKey,
                  <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;macKey)</code>&nbsp;</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildSessionConfirmedPackets-net.i2p.router.transport.udp.OutboundEstablishState-net.i2p.data.router.RouterIdentity-">buildSessionConfirmedPackets</a></span>(<a href="../../../../../net/i2p/router/transport/udp/OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;state,
                            <a href="../../../../../net/i2p/data/router/RouterIdentity.html" title="class in net.i2p.data.router">RouterIdentity</a>&nbsp;ourIdentity)</code>
<div class="block">Build a new series of SessionConfirmed packets for the given peer, 
 encrypting it as necessary.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildSessionCreatedPacket-net.i2p.router.transport.udp.InboundEstablishState-int-net.i2p.data.SessionKey-">buildSessionCreatedPacket</a></span>(<a href="../../../../../net/i2p/router/transport/udp/InboundEstablishState.html" title="class in net.i2p.router.transport.udp">InboundEstablishState</a>&nbsp;state,
                         int&nbsp;externalPort,
                         <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;ourIntroKey)</code>
<div class="block">Build a new SessionCreated packet for the given peer, encrypting it 
 as necessary.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildSessionDestroyPacket-net.i2p.router.transport.udp.InboundEstablishState-">buildSessionDestroyPacket</a></span>(<a href="../../../../../net/i2p/router/transport/udp/InboundEstablishState.html" title="class in net.i2p.router.transport.udp">InboundEstablishState</a>&nbsp;peer)</code>
<div class="block">Build a destroy packet, which contains a header but no body.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildSessionDestroyPacket-net.i2p.router.transport.udp.OutboundEstablishState-">buildSessionDestroyPacket</a></span>(<a href="../../../../../net/i2p/router/transport/udp/OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;peer)</code>
<div class="block">Build a destroy packet, which contains a header but no body.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildSessionDestroyPacket-net.i2p.router.transport.udp.PeerState-">buildSessionDestroyPacket</a></span>(<a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer)</code>
<div class="block">Build a destroy packet, which contains a header but no body.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#buildSessionRequestPacket-net.i2p.router.transport.udp.OutboundEstablishState-">buildSessionRequestPacket</a></span>(<a href="../../../../../net/i2p/router/transport/udp/OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;state)</code>
<div class="block">Build a new SessionRequest packet for the given peer, encrypting it 
 as necessary.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.html#getMaxAdditionalFragmentSize-net.i2p.router.transport.udp.PeerState-int-int-">getMaxAdditionalFragmentSize</a></span>(<a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
                            int&nbsp;numFragments,
                            int&nbsp;curDataSize)</code>
<div class="block">Will a packet to 'peer' that already has 'numFragments' fragments
  totalling 'curDataSize' bytes fit another fragment of size 'newFragSize' ??

  This doesn't leave anything for acks.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="TYPE_FIRST">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_FIRST</h4>
<pre>static final&nbsp;int TYPE_FIRST</pre>
<div class="block">For debugging and stats only - does not go out on the wire.
  These are chosen to be higher than the highest I2NP message type,
  as a data packet is set to the underlying I2NP message type.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_FIRST">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TYPE_ACK">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_ACK</h4>
<pre>static final&nbsp;int TYPE_ACK</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_ACK">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TYPE_PUNCH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_PUNCH</h4>
<pre>static final&nbsp;int TYPE_PUNCH</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_PUNCH">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TYPE_RESP">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_RESP</h4>
<pre>static final&nbsp;int TYPE_RESP</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_RESP">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TYPE_INTRO">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_INTRO</h4>
<pre>static final&nbsp;int TYPE_INTRO</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_INTRO">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TYPE_RREQ">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_RREQ</h4>
<pre>static final&nbsp;int TYPE_RREQ</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_RREQ">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TYPE_TCB">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_TCB</h4>
<pre>static final&nbsp;int TYPE_TCB</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_TCB">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TYPE_TBC">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_TBC</h4>
<pre>static final&nbsp;int TYPE_TBC</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_TBC">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TYPE_TTA">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_TTA</h4>
<pre>static final&nbsp;int TYPE_TTA</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_TTA">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TYPE_TFA">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_TFA</h4>
<pre>static final&nbsp;int TYPE_TFA</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_TFA">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TYPE_CONF">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_CONF</h4>
<pre>static final&nbsp;int TYPE_CONF</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_CONF">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TYPE_SREQ">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_SREQ</h4>
<pre>static final&nbsp;int TYPE_SREQ</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_SREQ">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TYPE_CREAT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TYPE_CREAT</h4>
<pre>static final&nbsp;int TYPE_CREAT</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_CREAT">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="HEADER_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>HEADER_SIZE</h4>
<pre>public static final&nbsp;int HEADER_SIZE</pre>
<div class="block">if no extended options or rekey data, which we don't support  = 37</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.HEADER_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="FRAGMENT_HEADER_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FRAGMENT_HEADER_SIZE</h4>
<pre>public static final&nbsp;int FRAGMENT_HEADER_SIZE</pre>
<div class="block">4 byte msg ID + 3 byte fragment info</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.FRAGMENT_HEADER_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DATA_HEADER_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DATA_HEADER_SIZE</h4>
<pre>public static final&nbsp;int DATA_HEADER_SIZE</pre>
<div class="block">not including acks. 46</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.DATA_HEADER_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="IP_HEADER_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>IP_HEADER_SIZE</h4>
<pre>public static final&nbsp;int IP_HEADER_SIZE</pre>
<div class="block">IPv4 only</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.IP_HEADER_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="UDP_HEADER_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>UDP_HEADER_SIZE</h4>
<pre>public static final&nbsp;int UDP_HEADER_SIZE</pre>
<div class="block">Same for IPv4 and IPv6</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.UDP_HEADER_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="MIN_DATA_PACKET_OVERHEAD">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MIN_DATA_PACKET_OVERHEAD</h4>
<pre>public static final&nbsp;int MIN_DATA_PACKET_OVERHEAD</pre>
<div class="block">74</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.MIN_DATA_PACKET_OVERHEAD">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="IPV6_HEADER_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>IPV6_HEADER_SIZE</h4>
<pre>public static final&nbsp;int IPV6_HEADER_SIZE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.IPV6_HEADER_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="MIN_IPV6_DATA_PACKET_OVERHEAD">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MIN_IPV6_DATA_PACKET_OVERHEAD</h4>
<pre>public static final&nbsp;int MIN_IPV6_DATA_PACKET_OVERHEAD</pre>
<div class="block">94</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.MIN_IPV6_DATA_PACKET_OVERHEAD">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="ABSOLUTE_MAX_ACKS">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ABSOLUTE_MAX_ACKS</h4>
<pre>public static final&nbsp;int ABSOLUTE_MAX_ACKS</pre>
<div class="block">one byte field</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.ABSOLUTE_MAX_ACKS">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="PacketBuilder-net.i2p.router.RouterContext-net.i2p.router.transport.udp.UDPTransport-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>PacketBuilder</h4>
<pre>public&nbsp;PacketBuilder(<a href="../../../../../net/i2p/router/RouterContext.html" title="class in net.i2p.router">RouterContext</a>&nbsp;ctx,
                     <a href="../../../../../net/i2p/router/transport/udp/UDPTransport.html" title="class in net.i2p.router.transport.udp">UDPTransport</a>&nbsp;transport)</pre>
<div class="block">No state, all methods are thread-safe.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>transport</code> - may be null for unit testing only</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getMaxAdditionalFragmentSize-net.i2p.router.transport.udp.PeerState-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMaxAdditionalFragmentSize</h4>
<pre>public static&nbsp;int&nbsp;getMaxAdditionalFragmentSize(<a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
                                               int&nbsp;numFragments,
                                               int&nbsp;curDataSize)</pre>
<div class="block">Will a packet to 'peer' that already has 'numFragments' fragments
  totalling 'curDataSize' bytes fit another fragment of size 'newFragSize' ??

  This doesn't leave anything for acks.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>numFragments</code> - &gt;= 1</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.16</dd>
</dl>
</li>
</ul>
<a name="buildPacket-net.i2p.router.transport.udp.OutboundMessageState-int-net.i2p.router.transport.udp.PeerState-java.util.Collection-int-java.util.List-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildPacket</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildPacket(<a href="../../../../../net/i2p/router/transport/udp/OutboundMessageState.html" title="class in net.i2p.router.transport.udp">OutboundMessageState</a>&nbsp;state,
                             int&nbsp;fragment,
                             <a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
                             <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&gt;&nbsp;ackIdsRemaining,
                             int&nbsp;newAckCount,
                             <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../net/i2p/router/transport/udp/ACKBitfield.html" title="interface in net.i2p.router.transport.udp">ACKBitfield</a>&gt;&nbsp;partialACKsRemaining)</pre>
<div class="block">This builds a data packet (PAYLOAD_TYPE_DATA).
 See the methods below for the other message types.

 Note that while the UDP message spec allows for more than one fragment in a message,
 this method writes exactly one fragment.
 For no fragments use buildAck().
 Multiple fragments in a single packet is not supported.
 Rekeying and extended options are not supported.

 Packet format:
<pre>
    16 byte MAC
    16 byte IV
     1 byte flag
     4 byte date
     1 byte flag
     1 byte explicit ack count IF included
   4*n byte explict acks IF included
     1 byte ack bitfield count IF included
   4*n + ?? ack bitfields IF included
     1 byte fragment count (always 1)
     4 byte message ID
     3 byte fragment info
     n byte fragment
  0-15 bytes padding
</pre>

 So ignoring the ack bitfields, and assuming we have explicit acks,
 it's (47 + 4*explict acks + padding) added to the
 fragment length.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ackIdsRemaining</code> - list of messageIds (Long) that should be acked by this packet.  
                        The list itself is passed by reference, and if a messageId is
                        transmitted it will be removed from the list.
                        Not all message IDs will necessarily be sent, there may not be room.
                        non-null.</dd>
<dd><code>newAckCount</code> - the number of ackIdsRemaining entries that are new. These must be the first
                    ones in the list</dd>
<dd><code>partialACKsRemaining</code> - list of messageIds (ACKBitfield) that should be acked by this packet.  
                        The list itself is passed by reference, and if a messageId is
                        included, it should be removed from the list.
                        Full acks in this list are skipped, they are NOT transmitted.
                        non-null.
                        Not all acks will necessarily be sent, there may not be room.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>null on error</dd>
</dl>
</li>
</ul>
<a name="buildPacket-java.util.List-net.i2p.router.transport.udp.PeerState-java.util.Collection-int-java.util.List-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildPacket</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildPacket(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.Fragment.html" title="class in net.i2p.router.transport.udp">PacketBuilder.Fragment</a>&gt;&nbsp;fragments,
                             <a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
                             <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&gt;&nbsp;ackIdsRemaining,
                             int&nbsp;newAckCount,
                             <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../net/i2p/router/transport/udp/ACKBitfield.html" title="interface in net.i2p.router.transport.udp">ACKBitfield</a>&gt;&nbsp;partialACKsRemaining)</pre>
</li>
</ul>
<a name="buildPing-net.i2p.router.transport.udp.PeerState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildPing</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildPing(<a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer)</pre>
<div class="block">An ACK packet with no acks.
 We use this for keepalive purposes.
 It doesn't generate a reply, but that's ok.</div>
</li>
</ul>
<a name="buildACK-net.i2p.router.transport.udp.PeerState-java.util.List-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildACK</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildACK(<a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
                          <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../net/i2p/router/transport/udp/ACKBitfield.html" title="interface in net.i2p.router.transport.udp">ACKBitfield</a>&gt;&nbsp;ackBitfields)</pre>
<div class="block">Build the ack packet. The list need not be sorted into full and partial;
  this method will put all fulls before the partials in the outgoing packet.
  An ack packet is just a data packet with no data.
  See buildPacket() for format.

  TODO MTU not enforced.
  TODO handle huge number of acks better</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ackBitfields</code> - list of ACKBitfield instances to either fully or partially ACK</dd>
</dl>
</li>
</ul>
<a name="buildSessionCreatedPacket-net.i2p.router.transport.udp.InboundEstablishState-int-net.i2p.data.SessionKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildSessionCreatedPacket</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildSessionCreatedPacket(<a href="../../../../../net/i2p/router/transport/udp/InboundEstablishState.html" title="class in net.i2p.router.transport.udp">InboundEstablishState</a>&nbsp;state,
                                           int&nbsp;externalPort,
                                           <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;ourIntroKey)</pre>
<div class="block">Build a new SessionCreated packet for the given peer, encrypting it 
 as necessary.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</li>
</ul>
<a name="buildSessionRequestPacket-net.i2p.router.transport.udp.OutboundEstablishState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildSessionRequestPacket</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildSessionRequestPacket(<a href="../../../../../net/i2p/router/transport/udp/OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;state)</pre>
<div class="block">Build a new SessionRequest packet for the given peer, encrypting it 
 as necessary.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</li>
</ul>
<a name="buildSessionConfirmedPackets-net.i2p.router.transport.udp.OutboundEstablishState-net.i2p.data.router.RouterIdentity-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildSessionConfirmedPackets</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>[]&nbsp;buildSessionConfirmedPackets(<a href="../../../../../net/i2p/router/transport/udp/OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;state,
                                                <a href="../../../../../net/i2p/data/router/RouterIdentity.html" title="class in net.i2p.data.router">RouterIdentity</a>&nbsp;ourIdentity)</pre>
<div class="block">Build a new series of SessionConfirmed packets for the given peer, 
 encrypting it as necessary.

 Note that while a SessionConfirmed could in theory be fragmented,
 in practice a RouterIdentity is 387 bytes and a single fragment is 512 bytes max,
 so it will never be fragmented.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>ready to send packets, or null if there was a problem
 
 TODO: doesn't really return null, and caller doesn't handle null return
 (null SigningPrivateKey should cause this?)
 Should probably return null if buildSessionConfirmedPacket() returns null for any fragment</dd>
</dl>
</li>
</ul>
<a name="buildSessionDestroyPacket-net.i2p.router.transport.udp.PeerState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildSessionDestroyPacket</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildSessionDestroyPacket(<a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer)</pre>
<div class="block">Build a destroy packet, which contains a header but no body.
  Session must be established or this will NPE in authenticate().
  Unused until 0.8.9.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8.1</dd>
</dl>
</li>
</ul>
<a name="buildSessionDestroyPacket-net.i2p.router.transport.udp.OutboundEstablishState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildSessionDestroyPacket</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildSessionDestroyPacket(<a href="../../../../../net/i2p/router/transport/udp/OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;peer)</pre>
<div class="block">Build a destroy packet, which contains a header but no body.
  If the keys and ip/port are not yet set, this will return null.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>packet or null</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.2</dd>
</dl>
</li>
</ul>
<a name="buildSessionDestroyPacket-net.i2p.router.transport.udp.InboundEstablishState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildSessionDestroyPacket</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildSessionDestroyPacket(<a href="../../../../../net/i2p/router/transport/udp/InboundEstablishState.html" title="class in net.i2p.router.transport.udp">InboundEstablishState</a>&nbsp;peer)</pre>
<div class="block">Build a destroy packet, which contains a header but no body.
  If the keys and ip/port are not yet set, this will return null.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>packet or null</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.2</dd>
</dl>
</li>
</ul>
<a name="buildPeerTestFromAlice-java.net.InetAddress-int-net.i2p.data.SessionKey-long-net.i2p.data.SessionKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildPeerTestFromAlice</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildPeerTestFromAlice(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;toIP,
                                        int&nbsp;toPort,
                                        <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;toIntroKey,
                                        long&nbsp;nonce,
                                        <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey)</pre>
<div class="block">Build a packet as if we are Alice and we either want Bob to begin a 
 peer test or Charlie to finish a peer test.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</li>
</ul>
<a name="buildPeerTestFromAlice-java.net.InetAddress-int-net.i2p.data.SessionKey-net.i2p.data.SessionKey-long-net.i2p.data.SessionKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildPeerTestFromAlice</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildPeerTestFromAlice(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;toIP,
                                        int&nbsp;toPort,
                                        <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;toCipherKey,
                                        <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;toMACKey,
                                        long&nbsp;nonce,
                                        <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey)</pre>
<div class="block">Build a packet as if we are Alice and we either want Bob to begin a 
 peer test or Charlie to finish a peer test.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</li>
</ul>
<a name="buildPeerTestToAlice-java.net.InetAddress-int-net.i2p.data.SessionKey-net.i2p.data.SessionKey-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildPeerTestToAlice</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildPeerTestToAlice(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;aliceIP,
                                      int&nbsp;alicePort,
                                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey,
                                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieIntroKey,
                                      long&nbsp;nonce)</pre>
<div class="block">Build a packet as if we are either Bob or Charlie and we are helping test Alice.
 Not for use as Bob, as of 0.9.52; use in-session cipher/mac keys instead.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</li>
</ul>
<a name="buildPeerTestToAlice-java.net.InetAddress-int-net.i2p.data.SessionKey-net.i2p.data.SessionKey-net.i2p.data.SessionKey-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildPeerTestToAlice</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildPeerTestToAlice(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;aliceIP,
                                      int&nbsp;alicePort,
                                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceCipherKey,
                                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceMACKey,
                                      <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieIntroKey,
                                      long&nbsp;nonce)</pre>
<div class="block">Build a packet as if we are either Bob or Charlie and we are helping test Alice.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>aliceCipherKey</code> - the intro key if we are Charlie</dd>
<dd><code>aliceMACKey</code> - the intro key if we are Charlie</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>ready to send packet, or null if there was a problem</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.52</dd>
</dl>
</li>
</ul>
<a name="buildPeerTestToCharlie-java.net.InetAddress-int-net.i2p.data.SessionKey-long-java.net.InetAddress-int-net.i2p.data.SessionKey-net.i2p.data.SessionKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildPeerTestToCharlie</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildPeerTestToCharlie(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;aliceIP,
                                        int&nbsp;alicePort,
                                        <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey,
                                        long&nbsp;nonce,
                                        <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;charlieIP,
                                        int&nbsp;charliePort,
                                        <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieCipherKey,
                                        <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieMACKey)</pre>
<div class="block">Build a packet as if we are Bob sending Charlie a packet to help test Alice.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</li>
</ul>
<a name="buildPeerTestToBob-java.net.InetAddress-int-java.net.InetAddress-int-net.i2p.data.SessionKey-long-net.i2p.data.SessionKey-net.i2p.data.SessionKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildPeerTestToBob</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildPeerTestToBob(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;bobIP,
                                    int&nbsp;bobPort,
                                    <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;aliceIP,
                                    int&nbsp;alicePort,
                                    <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey,
                                    long&nbsp;nonce,
                                    <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;bobCipherKey,
                                    <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;bobMACKey)</pre>
<div class="block">Build a packet as if we are Charlie sending Bob a packet verifying that we will help test Alice.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</li>
</ul>
<a name="buildRelayRequest-net.i2p.router.transport.udp.UDPTransport-net.i2p.router.transport.udp.EstablishmentManager-net.i2p.router.transport.udp.OutboundEstablishState-net.i2p.data.SessionKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildRelayRequest</h4>
<pre>public&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&gt;&nbsp;buildRelayRequest(<a href="../../../../../net/i2p/router/transport/udp/UDPTransport.html" title="class in net.i2p.router.transport.udp">UDPTransport</a>&nbsp;transport,
                                         <a href="../../../../../net/i2p/router/transport/udp/EstablishmentManager.html" title="class in net.i2p.router.transport.udp">EstablishmentManager</a>&nbsp;emgr,
                                         <a href="../../../../../net/i2p/router/transport/udp/OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;state,
                                         <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;ourIntroKey)</pre>
<div class="block">build intro packets for each of the published introducers</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>emgr</code> - only to call emgr.isValid()</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>empty list on failure</dd>
</dl>
</li>
</ul>
<a name="buildRelayIntro-net.i2p.router.transport.udp.RemoteHostId-net.i2p.router.transport.udp.PeerState-net.i2p.router.transport.udp.UDPPacketReader.RelayRequestReader-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildRelayIntro</h4>
<pre><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildRelayIntro(<a href="../../../../../net/i2p/router/transport/udp/RemoteHostId.html" title="class in net.i2p.router.transport.udp">RemoteHostId</a>&nbsp;alice,
                          <a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;charlie,
                          <a href="../../../../../net/i2p/router/transport/udp/UDPPacketReader.RelayRequestReader.html" title="class in net.i2p.router.transport.udp">UDPPacketReader.RelayRequestReader</a>&nbsp;request)</pre>
</li>
</ul>
<a name="buildRelayResponse-net.i2p.router.transport.udp.RemoteHostId-net.i2p.router.transport.udp.PeerState-long-net.i2p.data.SessionKey-net.i2p.data.SessionKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildRelayResponse</h4>
<pre><a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildRelayResponse(<a href="../../../../../net/i2p/router/transport/udp/RemoteHostId.html" title="class in net.i2p.router.transport.udp">RemoteHostId</a>&nbsp;alice,
                             <a href="../../../../../net/i2p/router/transport/udp/PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;charlie,
                             long&nbsp;nonce,
                             <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;cipherKey,
                             <a href="../../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;macKey)</pre>
</li>
</ul>
<a name="buildHolePunch-java.net.InetAddress-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildHolePunch</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildHolePunch(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;to,
                                int&nbsp;port)</pre>
<div class="block">Creates an empty unauthenticated packet for hole punching.
  Parameters must be validated previously.</div>
</li>
</ul>
<a name="buildPacket-byte:A-java.net.InetAddress-int-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>buildPacket</h4>
<pre>public&nbsp;<a href="../../../../../net/i2p/router/transport/udp/UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&nbsp;buildPacket(byte[]&nbsp;data,
                             <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html?is-external=true" title="class or interface in java.net">InetAddress</a>&nbsp;to,
                             int&nbsp;port)</pre>
<div class="block">TESTING ONLY.
  Creates an arbitrary packet for unit testing.
  Null transport in constructor OK.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>IPv6</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PacketBuilder.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../net/i2p/router/transport/udp/OutboundRefiller.html" title="class in net.i2p.router.transport.udp"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../net/i2p/router/transport/udp/PacketBuilder.Fragment.html" title="class in net.i2p.router.transport.udp"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?net/i2p/router/transport/udp/PacketBuilder.html" target="_top">Frames</a></li>
<li><a href="PacketBuilder.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
