<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (19) -->
<title>PacketBuilder (I2P Anonymous Network - Java Documentation - API Version 0.9.56)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: net.i2p.router.transport.udp, class: PacketBuilder">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/PacketBuilder.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li><a href="#nested-class-summary">Nested</a></li>
<li><a href="#field-summary">Field</a></li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li><a href="#field-detail">Field</a></li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">net.i2p.router.transport.udp</a></div>
<h1 title="Class PacketBuilder" class="title">Class PacketBuilder</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">net.i2p.router.transport.udp.PacketBuilder</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">class </span><span class="element-name type-name-label">PacketBuilder</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Big ol' class to do all our packet formatting.  The UDPPackets generated are
 fully authenticated, encrypted, and configured for delivery to the peer. 

 The following is from udp.html on the website:

<p>
All UDP datagrams begin with a 16 byte MAC (Message Authentication Code)
and a 16 byte IV (Initialization Vector
followed by a variable
size payload encrypted with the appropriate key.  The MAC used is 
HMAC-MD5, truncated to 16 bytes, while the key is a full 32 byte AES256 
key.  The specific construct of the MAC is the first 16 bytes from:</p>
<pre>
  HMAC-MD5(payload || IV || (payloadLength ^ protocolVersion), macKey)
</pre>

<p>The protocol version is currently 0.</p>

<p>The payload itself is AES256/CBC encrypted with the IV and the 
sessionKey, with replay prevention addressed within its body, 
explained below.  The payloadLength in the MAC is a 2 byte unsigned 
integer in 2s complement.</p>
  
<p>The protocolVersion is a 2 byte unsigned integer in 2s complement,
and currently set to 0.  Peers using a different protocol version will
not be able to communicate with this peer, though earlier versions not
using this flag are.</p>

<h2 id="payload">Payload</h2>

<p>Within the AES encrypted payload, there is a minimal common structure
to the various messages - a one byte flag and a four byte sending 
timestamp (*seconds* since the unix epoch).  The flag byte contains 
the following bitfields:</p>
<pre>
Bit order: 76543210
  bits 7-4: payload type
     bit 3: rekey?
     bit 2: extended options included
  bits 1-0: reserved
</pre>

<p>If the rekey flag is set, 64 bytes of keying material follow the 
timestamp.  If the extended options flag is set, a one byte option 
size value is appended to, followed by that many extended option 
bytes, which are currently uninterpreted.</p>

<p>When rekeying, the first 32 bytes of the keying material is fed 
into a SHA256 to produce the new MAC key, and the next 32 bytes are
fed into a SHA256 to produce the new session key, though the keys are
not immediately used.  The other side should also reply with the 
rekey flag set and that same keying material.  Once both sides have 
sent and received those values, the new keys should be used and the 
previous keys discarded.  It may be useful to keep the old keys 
around briefly, to address packet loss and reordering.</p>

<p>NOTE: Rekeying is currently unimplemented.</p>

<pre>
 Header: 37+ bytes
 +----+----+----+----+----+----+----+----+
 |                  MAC                  |
 |                                       |
 +----+----+----+----+----+----+----+----+
 |                   IV                  |
 |                                       |
 +----+----+----+----+----+----+----+----+
 |flag|        time       | (optionally  |
 +----+----+----+----+----+              |
 | this may have 64 byte keying material |
 | and/or a one+N byte extended options) |
 +---------------------------------------|
</pre></div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static class&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="PacketBuilder.Fragment.html" class="type-name-link" title="class in net.i2p.router.transport.udp">PacketBuilder.Fragment</a></code></div>
<div class="col-last even-row-color">
<div class="block">Class for passing multiple fragments to buildPacket()</div>
</div>
</div>
</section>
</li>
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static final int</code></div>
<div class="col-second even-row-color"><code><a href="#ABSOLUTE_MAX_ACKS" class="member-name-link">ABSOLUTE_MAX_ACKS</a></code></div>
<div class="col-last even-row-color">
<div class="block">one byte field</div>
</div>
<div class="col-first odd-row-color"><code>static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#DATA_HEADER_SIZE" class="member-name-link">DATA_HEADER_SIZE</a></code></div>
<div class="col-last odd-row-color">
<div class="block">not including acks.</div>
</div>
<div class="col-first even-row-color"><code>static final int</code></div>
<div class="col-second even-row-color"><code><a href="#FRAGMENT_HEADER_SIZE" class="member-name-link">FRAGMENT_HEADER_SIZE</a></code></div>
<div class="col-last even-row-color">
<div class="block">4 byte msg ID + 3 byte fragment info</div>
</div>
<div class="col-first odd-row-color"><code>static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#HEADER_SIZE" class="member-name-link">HEADER_SIZE</a></code></div>
<div class="col-last odd-row-color">
<div class="block">if no extended options or rekey data, which we don't support  = 37</div>
</div>
<div class="col-first even-row-color"><code>static final int</code></div>
<div class="col-second even-row-color"><code><a href="#IP_HEADER_SIZE" class="member-name-link">IP_HEADER_SIZE</a></code></div>
<div class="col-last even-row-color">
<div class="block">IPv4 only</div>
</div>
<div class="col-first odd-row-color"><code>static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#IPV6_HEADER_SIZE" class="member-name-link">IPV6_HEADER_SIZE</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static final int</code></div>
<div class="col-second even-row-color"><code><a href="#MIN_DATA_PACKET_OVERHEAD" class="member-name-link">MIN_DATA_PACKET_OVERHEAD</a></code></div>
<div class="col-last even-row-color">
<div class="block">74</div>
</div>
<div class="col-first odd-row-color"><code>static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#MIN_IPV6_DATA_PACKET_OVERHEAD" class="member-name-link">MIN_IPV6_DATA_PACKET_OVERHEAD</a></code></div>
<div class="col-last odd-row-color">
<div class="block">94</div>
</div>
<div class="col-first even-row-color"><code>(package private) static final int</code></div>
<div class="col-second even-row-color"><code><a href="#PRIORITY_HIGH" class="member-name-link">PRIORITY_HIGH</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>(package private) static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#TYPE_ACK" class="member-name-link">TYPE_ACK</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>(package private) static final int</code></div>
<div class="col-second even-row-color"><code><a href="#TYPE_CONF" class="member-name-link">TYPE_CONF</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>(package private) static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#TYPE_CREAT" class="member-name-link">TYPE_CREAT</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>(package private) static final int</code></div>
<div class="col-second even-row-color"><code><a href="#TYPE_FIRST" class="member-name-link">TYPE_FIRST</a></code></div>
<div class="col-last even-row-color">
<div class="block">For debugging and stats only - does not go out on the wire.</div>
</div>
<div class="col-first odd-row-color"><code>(package private) static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#TYPE_INTRO" class="member-name-link">TYPE_INTRO</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>(package private) static final int</code></div>
<div class="col-second even-row-color"><code><a href="#TYPE_PUNCH" class="member-name-link">TYPE_PUNCH</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>(package private) static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#TYPE_RESP" class="member-name-link">TYPE_RESP</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>(package private) static final int</code></div>
<div class="col-second even-row-color"><code><a href="#TYPE_RREQ" class="member-name-link">TYPE_RREQ</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>(package private) static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#TYPE_SREQ" class="member-name-link">TYPE_SREQ</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>(package private) static final int</code></div>
<div class="col-second even-row-color"><code><a href="#TYPE_TBC" class="member-name-link">TYPE_TBC</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>(package private) static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#TYPE_TCB" class="member-name-link">TYPE_TCB</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>(package private) static final int</code></div>
<div class="col-second even-row-color"><code><a href="#TYPE_TFA" class="member-name-link">TYPE_TFA</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>(package private) static final int</code></div>
<div class="col-second odd-row-color"><code><a href="#TYPE_TTA" class="member-name-link">TYPE_TTA</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static final int</code></div>
<div class="col-second even-row-color"><code><a href="#UDP_HEADER_SIZE" class="member-name-link">UDP_HEADER_SIZE</a></code></div>
<div class="col-last even-row-color">
<div class="block">Same for IPv4 and IPv6</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(net.i2p.router.RouterContext,net.i2p.router.transport.udp.UDPTransport)" class="member-name-link">PacketBuilder</a><wbr>(<a href="../../RouterContext.html" title="class in net.i2p.router">RouterContext</a>&nbsp;ctx,
 <a href="UDPTransport.html" title="class in net.i2p.router.transport.udp">UDPTransport</a>&nbsp;transport)</code></div>
<div class="col-last even-row-color">
<div class="block">No state, all methods are thread-safe.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildACK(net.i2p.router.transport.udp.PeerState,java.util.List)" class="member-name-link">buildACK</a><wbr>(<a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="ACKBitfield.html" title="interface in net.i2p.router.transport.udp">ACKBitfield</a>&gt;&nbsp;ackBitfields)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build the ack packet.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildHolePunch(java.net.InetAddress,int)" class="member-name-link">buildHolePunch</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;to,
 int&nbsp;port)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Creates an empty unauthenticated packet for hole punching.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildPacket(byte%5B%5D,java.net.InetAddress,int)" class="member-name-link">buildPacket</a><wbr>(byte[]&nbsp;data,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;to,
 int&nbsp;port)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">TESTING ONLY.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildPacket(java.util.List,net.i2p.router.transport.udp.PeerState,java.util.Collection,int,java.util.List)" class="member-name-link">buildPacket</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="PacketBuilder.Fragment.html" title="class in net.i2p.router.transport.udp">PacketBuilder.Fragment</a>&gt;&nbsp;fragments,
 <a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;&nbsp;ackIdsRemaining,
 int&nbsp;newAckCount,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="ACKBitfield.html" title="interface in net.i2p.router.transport.udp">ACKBitfield</a>&gt;&nbsp;partialACKsRemaining)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildPacket(net.i2p.router.transport.udp.OutboundMessageState,int,net.i2p.router.transport.udp.PeerState,java.util.Collection,int,java.util.List)" class="member-name-link">buildPacket</a><wbr>(<a href="OutboundMessageState.html" title="class in net.i2p.router.transport.udp">OutboundMessageState</a>&nbsp;state,
 int&nbsp;fragment,
 <a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;&nbsp;ackIdsRemaining,
 int&nbsp;newAckCount,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="ACKBitfield.html" title="interface in net.i2p.router.transport.udp">ACKBitfield</a>&gt;&nbsp;partialACKsRemaining)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">This builds a data packet (PAYLOAD_TYPE_DATA).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildPeerTestFromAlice(java.net.InetAddress,int,net.i2p.data.SessionKey,long,net.i2p.data.SessionKey)" class="member-name-link">buildPeerTestFromAlice</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;toIP,
 int&nbsp;toPort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;toIntroKey,
 long&nbsp;nonce,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build a packet as if we are Alice and we either want Bob to begin a 
 peer test or Charlie to finish a peer test.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildPeerTestFromAlice(java.net.InetAddress,int,net.i2p.data.SessionKey,net.i2p.data.SessionKey,long,net.i2p.data.SessionKey)" class="member-name-link">buildPeerTestFromAlice</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;toIP,
 int&nbsp;toPort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;toCipherKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;toMACKey,
 long&nbsp;nonce,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build a packet as if we are Alice and we either want Bob to begin a 
 peer test or Charlie to finish a peer test.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildPeerTestToAlice(java.net.InetAddress,int,net.i2p.data.SessionKey,net.i2p.data.SessionKey,long)" class="member-name-link">buildPeerTestToAlice</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;aliceIP,
 int&nbsp;alicePort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieIntroKey,
 long&nbsp;nonce)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build a packet as if we are either Bob or Charlie and we are helping test Alice.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildPeerTestToAlice(java.net.InetAddress,int,net.i2p.data.SessionKey,net.i2p.data.SessionKey,net.i2p.data.SessionKey,long)" class="member-name-link">buildPeerTestToAlice</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;aliceIP,
 int&nbsp;alicePort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceCipherKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceMACKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieIntroKey,
 long&nbsp;nonce)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build a packet as if we are either Bob or Charlie and we are helping test Alice.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildPeerTestToBob(java.net.InetAddress,int,java.net.InetAddress,int,net.i2p.data.SessionKey,long,net.i2p.data.SessionKey,net.i2p.data.SessionKey)" class="member-name-link">buildPeerTestToBob</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;bobIP,
 int&nbsp;bobPort,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;aliceIP,
 int&nbsp;alicePort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey,
 long&nbsp;nonce,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;bobCipherKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;bobMACKey)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build a packet as if we are Charlie sending Bob a packet verifying that we will help test Alice.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildPeerTestToCharlie(java.net.InetAddress,int,net.i2p.data.SessionKey,long,java.net.InetAddress,int,net.i2p.data.SessionKey,net.i2p.data.SessionKey)" class="member-name-link">buildPeerTestToCharlie</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;aliceIP,
 int&nbsp;alicePort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey,
 long&nbsp;nonce,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;charlieIP,
 int&nbsp;charliePort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieCipherKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieMACKey)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build a packet as if we are Bob sending Charlie a packet to help test Alice.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildPing(net.i2p.router.transport.udp.PeerState)" class="member-name-link">buildPing</a><wbr>(<a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">An ACK packet with no acks.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>(package private) <a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildRelayIntro(net.i2p.router.transport.udp.RemoteHostId,net.i2p.router.transport.udp.PeerState,net.i2p.router.transport.udp.UDPPacketReader.RelayRequestReader)" class="member-name-link">buildRelayIntro</a><wbr>(<a href="RemoteHostId.html" title="class in net.i2p.router.transport.udp">RemoteHostId</a>&nbsp;alice,
 <a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;charlie,
 <a href="UDPPacketReader.RelayRequestReader.html" title="class in net.i2p.router.transport.udp">UDPPacketReader.RelayRequestReader</a>&nbsp;request)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildRelayRequest(net.i2p.router.transport.udp.UDPTransport,net.i2p.router.transport.udp.EstablishmentManager,net.i2p.router.transport.udp.OutboundEstablishState,net.i2p.data.SessionKey)" class="member-name-link">buildRelayRequest</a><wbr>(<a href="UDPTransport.html" title="class in net.i2p.router.transport.udp">UDPTransport</a>&nbsp;transport,
 <a href="EstablishmentManager.html" title="class in net.i2p.router.transport.udp">EstablishmentManager</a>&nbsp;emgr,
 <a href="OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;state,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;ourIntroKey)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">build intro packets for each of the published introducers</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>(package private) <a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildRelayResponse(net.i2p.router.transport.udp.RemoteHostId,net.i2p.router.transport.udp.PeerState,long,net.i2p.data.SessionKey,net.i2p.data.SessionKey)" class="member-name-link">buildRelayResponse</a><wbr>(<a href="RemoteHostId.html" title="class in net.i2p.router.transport.udp">RemoteHostId</a>&nbsp;alice,
 <a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;charlie,
 long&nbsp;nonce,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;cipherKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;macKey)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildSessionConfirmedPackets(net.i2p.router.transport.udp.OutboundEstablishState,net.i2p.data.router.RouterIdentity)" class="member-name-link">buildSessionConfirmedPackets</a><wbr>(<a href="OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;state,
 <a href="../../../data/router/RouterIdentity.html" title="class in net.i2p.data.router">RouterIdentity</a>&nbsp;ourIdentity)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build a new series of SessionConfirmed packets for the given peer, 
 encrypting it as necessary.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildSessionCreatedPacket(net.i2p.router.transport.udp.InboundEstablishState,int,net.i2p.data.SessionKey)" class="member-name-link">buildSessionCreatedPacket</a><wbr>(<a href="InboundEstablishState.html" title="class in net.i2p.router.transport.udp">InboundEstablishState</a>&nbsp;state,
 int&nbsp;externalPort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;ourIntroKey)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build a new SessionCreated packet for the given peer, encrypting it 
 as necessary.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildSessionDestroyPacket(net.i2p.router.transport.udp.InboundEstablishState)" class="member-name-link">buildSessionDestroyPacket</a><wbr>(<a href="InboundEstablishState.html" title="class in net.i2p.router.transport.udp">InboundEstablishState</a>&nbsp;peer)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build a destroy packet, which contains a header but no body.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildSessionDestroyPacket(net.i2p.router.transport.udp.OutboundEstablishState)" class="member-name-link">buildSessionDestroyPacket</a><wbr>(<a href="OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;peer)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build a destroy packet, which contains a header but no body.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildSessionDestroyPacket(net.i2p.router.transport.udp.PeerState)" class="member-name-link">buildSessionDestroyPacket</a><wbr>(<a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build a destroy packet, which contains a header but no body.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#buildSessionRequestPacket(net.i2p.router.transport.udp.OutboundEstablishState)" class="member-name-link">buildSessionRequestPacket</a><wbr>(<a href="OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;state)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Build a new SessionRequest packet for the given peer, encrypting it 
 as necessary.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#getMaxAdditionalFragmentSize(net.i2p.router.transport.udp.PeerState,int,int)" class="member-name-link">getMaxAdditionalFragmentSize</a><wbr>(<a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
 int&nbsp;numFragments,
 int&nbsp;curDataSize)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Will a packet to 'peer' that already has 'numFragments' fragments
  totalling 'curDataSize' bytes fit another fragment of size 'newFragSize' ??

  This doesn't leave anything for acks.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="TYPE_FIRST">
<h3>TYPE_FIRST</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_FIRST</span></div>
<div class="block">For debugging and stats only - does not go out on the wire.
  These are chosen to be higher than the highest I2NP message type,
  as a data packet is set to the underlying I2NP message type.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_FIRST">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="TYPE_ACK">
<h3>TYPE_ACK</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_ACK</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_ACK">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="TYPE_PUNCH">
<h3>TYPE_PUNCH</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_PUNCH</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_PUNCH">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="TYPE_RESP">
<h3>TYPE_RESP</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_RESP</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_RESP">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="TYPE_INTRO">
<h3>TYPE_INTRO</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_INTRO</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_INTRO">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="TYPE_RREQ">
<h3>TYPE_RREQ</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_RREQ</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_RREQ">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="TYPE_TCB">
<h3>TYPE_TCB</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_TCB</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_TCB">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="TYPE_TBC">
<h3>TYPE_TBC</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_TBC</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_TBC">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="TYPE_TTA">
<h3>TYPE_TTA</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_TTA</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_TTA">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="TYPE_TFA">
<h3>TYPE_TFA</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_TFA</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_TFA">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="TYPE_CONF">
<h3>TYPE_CONF</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_CONF</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_CONF">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="TYPE_SREQ">
<h3>TYPE_SREQ</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_SREQ</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_SREQ">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="TYPE_CREAT">
<h3>TYPE_CREAT</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">TYPE_CREAT</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.TYPE_CREAT">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="HEADER_SIZE">
<h3>HEADER_SIZE</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">HEADER_SIZE</span></div>
<div class="block">if no extended options or rekey data, which we don't support  = 37</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.HEADER_SIZE">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="FRAGMENT_HEADER_SIZE">
<h3>FRAGMENT_HEADER_SIZE</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">FRAGMENT_HEADER_SIZE</span></div>
<div class="block">4 byte msg ID + 3 byte fragment info</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.FRAGMENT_HEADER_SIZE">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="DATA_HEADER_SIZE">
<h3>DATA_HEADER_SIZE</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">DATA_HEADER_SIZE</span></div>
<div class="block">not including acks. 46</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.DATA_HEADER_SIZE">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="IP_HEADER_SIZE">
<h3>IP_HEADER_SIZE</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">IP_HEADER_SIZE</span></div>
<div class="block">IPv4 only</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.IP_HEADER_SIZE">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="UDP_HEADER_SIZE">
<h3>UDP_HEADER_SIZE</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">UDP_HEADER_SIZE</span></div>
<div class="block">Same for IPv4 and IPv6</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.UDP_HEADER_SIZE">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="MIN_DATA_PACKET_OVERHEAD">
<h3>MIN_DATA_PACKET_OVERHEAD</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">MIN_DATA_PACKET_OVERHEAD</span></div>
<div class="block">74</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.MIN_DATA_PACKET_OVERHEAD">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="IPV6_HEADER_SIZE">
<h3>IPV6_HEADER_SIZE</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">IPV6_HEADER_SIZE</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.IPV6_HEADER_SIZE">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="MIN_IPV6_DATA_PACKET_OVERHEAD">
<h3>MIN_IPV6_DATA_PACKET_OVERHEAD</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">MIN_IPV6_DATA_PACKET_OVERHEAD</span></div>
<div class="block">94</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.MIN_IPV6_DATA_PACKET_OVERHEAD">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="ABSOLUTE_MAX_ACKS">
<h3>ABSOLUTE_MAX_ACKS</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">ABSOLUTE_MAX_ACKS</span></div>
<div class="block">one byte field</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.ABSOLUTE_MAX_ACKS">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="PRIORITY_HIGH">
<h3>PRIORITY_HIGH</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">PRIORITY_HIGH</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../../constant-values.html#net.i2p.router.transport.udp.PacketBuilder.PRIORITY_HIGH">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(net.i2p.router.RouterContext,net.i2p.router.transport.udp.UDPTransport)">
<h3>PacketBuilder</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">PacketBuilder</span><wbr><span class="parameters">(<a href="../../RouterContext.html" title="class in net.i2p.router">RouterContext</a>&nbsp;ctx,
 <a href="UDPTransport.html" title="class in net.i2p.router.transport.udp">UDPTransport</a>&nbsp;transport)</span></div>
<div class="block">No state, all methods are thread-safe.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>transport</code> - may be null for unit testing only</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getMaxAdditionalFragmentSize(net.i2p.router.transport.udp.PeerState,int,int)">
<h3>getMaxAdditionalFragmentSize</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getMaxAdditionalFragmentSize</span><wbr><span class="parameters">(<a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
 int&nbsp;numFragments,
 int&nbsp;curDataSize)</span></div>
<div class="block">Will a packet to 'peer' that already has 'numFragments' fragments
  totalling 'curDataSize' bytes fit another fragment of size 'newFragSize' ??

  This doesn't leave anything for acks.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>numFragments</code> - &gt;= 1</dd>
<dt>Since:</dt>
<dd>0.9.16</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildPacket(net.i2p.router.transport.udp.OutboundMessageState,int,net.i2p.router.transport.udp.PeerState,java.util.Collection,int,java.util.List)">
<h3>buildPacket</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildPacket</span><wbr><span class="parameters">(<a href="OutboundMessageState.html" title="class in net.i2p.router.transport.udp">OutboundMessageState</a>&nbsp;state,
 int&nbsp;fragment,
 <a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;&nbsp;ackIdsRemaining,
 int&nbsp;newAckCount,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="ACKBitfield.html" title="interface in net.i2p.router.transport.udp">ACKBitfield</a>&gt;&nbsp;partialACKsRemaining)</span></div>
<div class="block">This builds a data packet (PAYLOAD_TYPE_DATA).
 See the methods below for the other message types.

 Note that while the UDP message spec allows for more than one fragment in a message,
 this method writes exactly one fragment.
 For no fragments use buildAck().
 Multiple fragments in a single packet is not supported.
 Rekeying and extended options are not supported.

 Packet format:
<pre>
    16 byte MAC
    16 byte IV
     1 byte flag
     4 byte date
     1 byte flag
     1 byte explicit ack count IF included
   4*n byte explict acks IF included
     1 byte ack bitfield count IF included
   4*n + ?? ack bitfields IF included
     1 byte fragment count (always 1)
     4 byte message ID
     3 byte fragment info
     n byte fragment
  0-15 bytes padding
</pre>

 So ignoring the ack bitfields, and assuming we have explicit acks,
 it's (47 + 4*explict acks + padding) added to the
 fragment length.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>ackIdsRemaining</code> - list of messageIds (Long) that should be acked by this packet.  
                        The list itself is passed by reference, and if a messageId is
                        transmitted it will be removed from the list.
                        Not all message IDs will necessarily be sent, there may not be room.
                        non-null.</dd>
<dd><code>newAckCount</code> - the number of ackIdsRemaining entries that are new. These must be the first
                    ones in the list</dd>
<dd><code>partialACKsRemaining</code> - list of messageIds (ACKBitfield) that should be acked by this packet.  
                        The list itself is passed by reference, and if a messageId is
                        included, it should be removed from the list.
                        Full acks in this list are skipped, they are NOT transmitted.
                        non-null.
                        Not all acks will necessarily be sent, there may not be room.</dd>
<dt>Returns:</dt>
<dd>null on error</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildPacket(java.util.List,net.i2p.router.transport.udp.PeerState,java.util.Collection,int,java.util.List)">
<h3>buildPacket</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildPacket</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="PacketBuilder.Fragment.html" title="class in net.i2p.router.transport.udp">PacketBuilder.Fragment</a>&gt;&nbsp;fragments,
 <a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;&nbsp;ackIdsRemaining,
 int&nbsp;newAckCount,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="ACKBitfield.html" title="interface in net.i2p.router.transport.udp">ACKBitfield</a>&gt;&nbsp;partialACKsRemaining)</span></div>
</section>
</li>
<li>
<section class="detail" id="buildPing(net.i2p.router.transport.udp.PeerState)">
<h3>buildPing</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildPing</span><wbr><span class="parameters">(<a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer)</span></div>
<div class="block">An ACK packet with no acks.
 We use this for keepalive purposes.
 It doesn't generate a reply, but that's ok.</div>
</section>
</li>
<li>
<section class="detail" id="buildACK(net.i2p.router.transport.udp.PeerState,java.util.List)">
<h3>buildACK</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildACK</span><wbr><span class="parameters">(<a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="ACKBitfield.html" title="interface in net.i2p.router.transport.udp">ACKBitfield</a>&gt;&nbsp;ackBitfields)</span></div>
<div class="block">Build the ack packet. The list need not be sorted into full and partial;
  this method will put all fulls before the partials in the outgoing packet.
  An ack packet is just a data packet with no data.
  See buildPacket() for format.

  TODO MTU not enforced.
  TODO handle huge number of acks better</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>ackBitfields</code> - list of ACKBitfield instances to either fully or partially ACK</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildSessionCreatedPacket(net.i2p.router.transport.udp.InboundEstablishState,int,net.i2p.data.SessionKey)">
<h3>buildSessionCreatedPacket</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildSessionCreatedPacket</span><wbr><span class="parameters">(<a href="InboundEstablishState.html" title="class in net.i2p.router.transport.udp">InboundEstablishState</a>&nbsp;state,
 int&nbsp;externalPort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;ourIntroKey)</span></div>
<div class="block">Build a new SessionCreated packet for the given peer, encrypting it 
 as necessary.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildSessionRequestPacket(net.i2p.router.transport.udp.OutboundEstablishState)">
<h3>buildSessionRequestPacket</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildSessionRequestPacket</span><wbr><span class="parameters">(<a href="OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;state)</span></div>
<div class="block">Build a new SessionRequest packet for the given peer, encrypting it 
 as necessary.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildSessionConfirmedPackets(net.i2p.router.transport.udp.OutboundEstablishState,net.i2p.data.router.RouterIdentity)">
<h3>buildSessionConfirmedPackets</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>[]</span>&nbsp;<span class="element-name">buildSessionConfirmedPackets</span><wbr><span class="parameters">(<a href="OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;state,
 <a href="../../../data/router/RouterIdentity.html" title="class in net.i2p.data.router">RouterIdentity</a>&nbsp;ourIdentity)</span></div>
<div class="block">Build a new series of SessionConfirmed packets for the given peer, 
 encrypting it as necessary.

 Note that while a SessionConfirmed could in theory be fragmented,
 in practice a RouterIdentity is 387 bytes and a single fragment is 512 bytes max,
 so it will never be fragmented.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>ready to send packets, or null if there was a problem
 
 TODO: doesn't really return null, and caller doesn't handle null return
 (null SigningPrivateKey should cause this?)
 Should probably return null if buildSessionConfirmedPacket() returns null for any fragment</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildSessionDestroyPacket(net.i2p.router.transport.udp.PeerState)">
<h3>buildSessionDestroyPacket</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildSessionDestroyPacket</span><wbr><span class="parameters">(<a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;peer)</span></div>
<div class="block">Build a destroy packet, which contains a header but no body.
  Session must be established or this will NPE in authenticate().
  Unused until 0.8.9.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>0.8.1</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildSessionDestroyPacket(net.i2p.router.transport.udp.OutboundEstablishState)">
<h3>buildSessionDestroyPacket</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildSessionDestroyPacket</span><wbr><span class="parameters">(<a href="OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;peer)</span></div>
<div class="block">Build a destroy packet, which contains a header but no body.
  If the keys and ip/port are not yet set, this will return null.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>packet or null</dd>
<dt>Since:</dt>
<dd>0.9.2</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildSessionDestroyPacket(net.i2p.router.transport.udp.InboundEstablishState)">
<h3>buildSessionDestroyPacket</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildSessionDestroyPacket</span><wbr><span class="parameters">(<a href="InboundEstablishState.html" title="class in net.i2p.router.transport.udp">InboundEstablishState</a>&nbsp;peer)</span></div>
<div class="block">Build a destroy packet, which contains a header but no body.
  If the keys and ip/port are not yet set, this will return null.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>packet or null</dd>
<dt>Since:</dt>
<dd>0.9.2</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildPeerTestFromAlice(java.net.InetAddress,int,net.i2p.data.SessionKey,long,net.i2p.data.SessionKey)">
<h3>buildPeerTestFromAlice</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildPeerTestFromAlice</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;toIP,
 int&nbsp;toPort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;toIntroKey,
 long&nbsp;nonce,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey)</span></div>
<div class="block">Build a packet as if we are Alice and we either want Bob to begin a 
 peer test or Charlie to finish a peer test.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildPeerTestFromAlice(java.net.InetAddress,int,net.i2p.data.SessionKey,net.i2p.data.SessionKey,long,net.i2p.data.SessionKey)">
<h3>buildPeerTestFromAlice</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildPeerTestFromAlice</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;toIP,
 int&nbsp;toPort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;toCipherKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;toMACKey,
 long&nbsp;nonce,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey)</span></div>
<div class="block">Build a packet as if we are Alice and we either want Bob to begin a 
 peer test or Charlie to finish a peer test.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildPeerTestToAlice(java.net.InetAddress,int,net.i2p.data.SessionKey,net.i2p.data.SessionKey,long)">
<h3>buildPeerTestToAlice</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildPeerTestToAlice</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;aliceIP,
 int&nbsp;alicePort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieIntroKey,
 long&nbsp;nonce)</span></div>
<div class="block">Build a packet as if we are either Bob or Charlie and we are helping test Alice.
 Not for use as Bob, as of 0.9.52; use in-session cipher/mac keys instead.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildPeerTestToAlice(java.net.InetAddress,int,net.i2p.data.SessionKey,net.i2p.data.SessionKey,net.i2p.data.SessionKey,long)">
<h3>buildPeerTestToAlice</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildPeerTestToAlice</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;aliceIP,
 int&nbsp;alicePort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceCipherKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceMACKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieIntroKey,
 long&nbsp;nonce)</span></div>
<div class="block">Build a packet as if we are either Bob or Charlie and we are helping test Alice.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>aliceCipherKey</code> - the intro key if we are Charlie</dd>
<dd><code>aliceMACKey</code> - the intro key if we are Charlie</dd>
<dt>Returns:</dt>
<dd>ready to send packet, or null if there was a problem</dd>
<dt>Since:</dt>
<dd>0.9.52</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildPeerTestToCharlie(java.net.InetAddress,int,net.i2p.data.SessionKey,long,java.net.InetAddress,int,net.i2p.data.SessionKey,net.i2p.data.SessionKey)">
<h3>buildPeerTestToCharlie</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildPeerTestToCharlie</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;aliceIP,
 int&nbsp;alicePort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey,
 long&nbsp;nonce,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;charlieIP,
 int&nbsp;charliePort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieCipherKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;charlieMACKey)</span></div>
<div class="block">Build a packet as if we are Bob sending Charlie a packet to help test Alice.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildPeerTestToBob(java.net.InetAddress,int,java.net.InetAddress,int,net.i2p.data.SessionKey,long,net.i2p.data.SessionKey,net.i2p.data.SessionKey)">
<h3>buildPeerTestToBob</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildPeerTestToBob</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;bobIP,
 int&nbsp;bobPort,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;aliceIP,
 int&nbsp;alicePort,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;aliceIntroKey,
 long&nbsp;nonce,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;bobCipherKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;bobMACKey)</span></div>
<div class="block">Build a packet as if we are Charlie sending Bob a packet verifying that we will help test Alice.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>ready to send packet, or null if there was a problem</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildRelayRequest(net.i2p.router.transport.udp.UDPTransport,net.i2p.router.transport.udp.EstablishmentManager,net.i2p.router.transport.udp.OutboundEstablishState,net.i2p.data.SessionKey)">
<h3>buildRelayRequest</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a>&gt;</span>&nbsp;<span class="element-name">buildRelayRequest</span><wbr><span class="parameters">(<a href="UDPTransport.html" title="class in net.i2p.router.transport.udp">UDPTransport</a>&nbsp;transport,
 <a href="EstablishmentManager.html" title="class in net.i2p.router.transport.udp">EstablishmentManager</a>&nbsp;emgr,
 <a href="OutboundEstablishState.html" title="class in net.i2p.router.transport.udp">OutboundEstablishState</a>&nbsp;state,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;ourIntroKey)</span></div>
<div class="block">build intro packets for each of the published introducers</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>emgr</code> - only to call emgr.isValid()</dd>
<dt>Returns:</dt>
<dd>empty list on failure</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="buildRelayIntro(net.i2p.router.transport.udp.RemoteHostId,net.i2p.router.transport.udp.PeerState,net.i2p.router.transport.udp.UDPPacketReader.RelayRequestReader)">
<h3>buildRelayIntro</h3>
<div class="member-signature"><span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildRelayIntro</span><wbr><span class="parameters">(<a href="RemoteHostId.html" title="class in net.i2p.router.transport.udp">RemoteHostId</a>&nbsp;alice,
 <a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;charlie,
 <a href="UDPPacketReader.RelayRequestReader.html" title="class in net.i2p.router.transport.udp">UDPPacketReader.RelayRequestReader</a>&nbsp;request)</span></div>
</section>
</li>
<li>
<section class="detail" id="buildRelayResponse(net.i2p.router.transport.udp.RemoteHostId,net.i2p.router.transport.udp.PeerState,long,net.i2p.data.SessionKey,net.i2p.data.SessionKey)">
<h3>buildRelayResponse</h3>
<div class="member-signature"><span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildRelayResponse</span><wbr><span class="parameters">(<a href="RemoteHostId.html" title="class in net.i2p.router.transport.udp">RemoteHostId</a>&nbsp;alice,
 <a href="PeerState.html" title="class in net.i2p.router.transport.udp">PeerState</a>&nbsp;charlie,
 long&nbsp;nonce,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;cipherKey,
 <a href="../../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;macKey)</span></div>
</section>
</li>
<li>
<section class="detail" id="buildHolePunch(java.net.InetAddress,int)">
<h3>buildHolePunch</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildHolePunch</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;to,
 int&nbsp;port)</span></div>
<div class="block">Creates an empty unauthenticated packet for hole punching.
  Parameters must be validated previously.</div>
</section>
</li>
<li>
<section class="detail" id="buildPacket(byte[],java.net.InetAddress,int)">
<h3>buildPacket</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="UDPPacket.html" title="class in net.i2p.router.transport.udp">UDPPacket</a></span>&nbsp;<span class="element-name">buildPacket</span><wbr><span class="parameters">(byte[]&nbsp;data,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html" title="class or interface in java.net" class="external-link">InetAddress</a>&nbsp;to,
 int&nbsp;port)</span></div>
<div class="block">TESTING ONLY.
  Creates an arbitrary packet for unit testing.
  Null transport in constructor OK.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>IPv6</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
