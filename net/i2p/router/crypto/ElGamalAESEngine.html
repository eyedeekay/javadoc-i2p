<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>ElGamalAESEngine (I2P Anonymous Network - Java Documentation - Version 1.6.1)</title>
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ElGamalAESEngine (I2P Anonymous Network - Java Documentation - Version 1.6.1)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":42,"i1":10,"i2":10,"i3":10,"i4":10,"i5":42,"i6":42,"i7":10,"i8":10,"i9":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"],32:["t6","Deprecated Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ElGamalAESEngine.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../net/i2p/router/crypto/FamilyKeyCrypto.html" title="class in net.i2p.router.crypto"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?net/i2p/router/crypto/ElGamalAESEngine.html" target="_top">Frames</a></li>
<li><a href="ElGamalAESEngine.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">net.i2p.router.crypto</div>
<h2 title="Class ElGamalAESEngine" class="title">Class ElGamalAESEngine</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>net.i2p.router.crypto.ElGamalAESEngine</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public final class <span class="typeNameLabel">ElGamalAESEngine</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">Handles the actual ElGamal+AES encryption and decryption scenarios using the
 supplied keys and data.

 No, this does not extend AESEngine or CryptixAESEngine.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.38 moved from net.i2p.crypto</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/i2p/router/crypto/ElGamalAESEngine.html#MAX_TAGS_RECEIVED">MAX_TAGS_RECEIVED</a></span></code>
<div class="block">enforced since release 0.6</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/i2p/router/crypto/ElGamalAESEngine.html#ElGamalAESEngine-net.i2p.I2PAppContext-">ElGamalAESEngine</a></span>(<a href="../../../../net/i2p/I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t6" class="tableTab"><span><a href="javascript:show(32);">Deprecated Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/i2p/router/crypto/ElGamalAESEngine.html#decrypt-byte:A-net.i2p.data.PrivateKey-">decrypt</a></span>(byte[]&nbsp;data,
       <a href="../../../../net/i2p/data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey)</code>
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;
<div class="block"><span class="deprecationComment">specify the key manager!</span></div>
</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/i2p/router/crypto/ElGamalAESEngine.html#decrypt-byte:A-net.i2p.data.PrivateKey-net.i2p.crypto.SessionKeyManager-">decrypt</a></span>(byte[]&nbsp;data,
       <a href="../../../../net/i2p/data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
       <a href="../../../../net/i2p/crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</code>
<div class="block">Decrypt the message using the given private key
 and using tags from the specified key manager.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>(package private) byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/i2p/router/crypto/ElGamalAESEngine.html#decryptAESBlock-byte:A-int-int-net.i2p.data.SessionKey-byte:A-byte:A-java.util.Set-net.i2p.data.SessionKey-">decryptAESBlock</a></span>(byte[]&nbsp;encrypted,
               int&nbsp;offset,
               int&nbsp;encryptedLen,
               <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
               byte[]&nbsp;iv,
               byte[]&nbsp;sentTag,
               <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;foundTags,
               <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;foundKey)</code>
<div class="block">private byte[] decryptAESBlock(byte encrypted[], SessionKey key, byte iv[], 
                           byte sentTag[], Set foundTags, SessionKey foundKey) throws DataFormatException {
        return decryptAESBlock(encrypted, 0, encrypted.length, key, iv, sentTag, foundTags, foundKey);
    }</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/i2p/router/crypto/ElGamalAESEngine.html#decryptFast-byte:A-net.i2p.data.PrivateKey-net.i2p.crypto.SessionKeyManager-">decryptFast</a></span>(byte[]&nbsp;data,
           <a href="../../../../net/i2p/data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
           <a href="../../../../net/i2p/crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</code>
<div class="block">Tags only.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/i2p/router/crypto/ElGamalAESEngine.html#decryptSlow-byte:A-net.i2p.data.PrivateKey-net.i2p.crypto.SessionKeyManager-">decryptSlow</a></span>(byte[]&nbsp;data,
           <a href="../../../../net/i2p/data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
           <a href="../../../../net/i2p/crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</code>
<div class="block">Full ElG only.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/i2p/router/crypto/ElGamalAESEngine.html#encrypt-byte:A-net.i2p.data.PublicKey-net.i2p.data.SessionKey-long-">encrypt</a></span>(byte[]&nbsp;data,
       <a href="../../../../net/i2p/data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
       <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
       long&nbsp;paddedSize)</code>
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;
<div class="block"><span class="deprecationComment">unused</span></div>
</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/i2p/router/crypto/ElGamalAESEngine.html#encrypt-byte:A-net.i2p.data.PublicKey-net.i2p.data.SessionKey-java.util.Set-long-">encrypt</a></span>(byte[]&nbsp;data,
       <a href="../../../../net/i2p/data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
       <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
       <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
       long&nbsp;paddedSize)</code>
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;
<div class="block"><span class="deprecationComment">unused</span></div>
</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/i2p/router/crypto/ElGamalAESEngine.html#encrypt-byte:A-net.i2p.data.PublicKey-net.i2p.data.SessionKey-java.util.Set-net.i2p.data.SessionTag-long-">encrypt</a></span>(byte[]&nbsp;data,
       <a href="../../../../net/i2p/data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
       <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
       <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
       <a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&nbsp;currentTag,
       long&nbsp;paddedSize)</code>
<div class="block">Encrypt the data to the target using the given key and deliver the specified tags
 No new session key
 This is the one called from GarlicMessageBuilder and is the primary entry point.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/i2p/router/crypto/ElGamalAESEngine.html#encrypt-byte:A-net.i2p.data.PublicKey-net.i2p.data.SessionKey-java.util.Set-net.i2p.data.SessionTag-net.i2p.data.SessionKey-long-">encrypt</a></span>(byte[]&nbsp;data,
       <a href="../../../../net/i2p/data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
       <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
       <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
       <a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&nbsp;currentTag,
       <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;newKey,
       long&nbsp;paddedSize)</code>
<div class="block">Encrypt the unencrypted data to the target.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>(package private) byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/i2p/router/crypto/ElGamalAESEngine.html#encryptAESBlock-byte:A-net.i2p.data.SessionKey-byte:A-java.util.Set-net.i2p.data.SessionKey-long-">encryptAESBlock</a></span>(byte[]&nbsp;data,
               <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
               byte[]&nbsp;iv,
               <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
               <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;newKey,
               long&nbsp;paddedSize)</code>
<div class="block">For both scenarios, this method encrypts the AES area using the given key, iv
 and making sure the resulting data is at least as long as the paddedSize and 
 also mod 16 bytes.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="MAX_TAGS_RECEIVED">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>MAX_TAGS_RECEIVED</h4>
<pre>public static final&nbsp;int MAX_TAGS_RECEIVED</pre>
<div class="block">enforced since release 0.6</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#net.i2p.router.crypto.ElGamalAESEngine.MAX_TAGS_RECEIVED">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ElGamalAESEngine-net.i2p.I2PAppContext-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ElGamalAESEngine</h4>
<pre>public&nbsp;ElGamalAESEngine(<a href="../../../../net/i2p/I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="decrypt-byte:A-net.i2p.data.PrivateKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decrypt</h4>
<pre><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Deprecated.html?is-external=true" title="class or interface in java.lang">@Deprecated</a>
public&nbsp;byte[]&nbsp;decrypt(byte[]&nbsp;data,
                                  <a href="../../../../net/i2p/data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey)
                           throws <a href="../../../../net/i2p/data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></pre>
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;<span class="deprecationComment">specify the key manager!</span></div>
<div class="block">Decrypt the message using the given private key using tags from the default key manager,
 which is the router's key manager. Use extreme care if you aren't the router.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../net/i2p/data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
</dl>
</li>
</ul>
<a name="decrypt-byte:A-net.i2p.data.PrivateKey-net.i2p.crypto.SessionKeyManager-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decrypt</h4>
<pre>public&nbsp;byte[]&nbsp;decrypt(byte[]&nbsp;data,
                      <a href="../../../../net/i2p/data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
                      <a href="../../../../net/i2p/crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)
               throws <a href="../../../../net/i2p/data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></pre>
<div class="block">Decrypt the message using the given private key
 and using tags from the specified key manager.
 This works according to the
 ElGamal+AES algorithm in the data structure spec.

 Warning - use the correct SessionKeyManager. Clients should instantiate their own.
 Clients using I2PAppContext.sessionKeyManager() may be correlated with the router,
 unless you are careful to use different keys.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>decrypted data or null on failure</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../net/i2p/data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
</dl>
</li>
</ul>
<a name="decryptFast-byte:A-net.i2p.data.PrivateKey-net.i2p.crypto.SessionKeyManager-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decryptFast</h4>
<pre>public&nbsp;byte[]&nbsp;decryptFast(byte[]&nbsp;data,
                          <a href="../../../../net/i2p/data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
                          <a href="../../../../net/i2p/crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)
                   throws <a href="../../../../net/i2p/data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></pre>
<div class="block">Tags only. For MuxedEngine use only.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>decrypted data or null on failure</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../net/i2p/data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.46</dd>
</dl>
</li>
</ul>
<a name="decryptSlow-byte:A-net.i2p.data.PrivateKey-net.i2p.crypto.SessionKeyManager-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decryptSlow</h4>
<pre>public&nbsp;byte[]&nbsp;decryptSlow(byte[]&nbsp;data,
                          <a href="../../../../net/i2p/data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
                          <a href="../../../../net/i2p/crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)
                   throws <a href="../../../../net/i2p/data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></pre>
<div class="block">Full ElG only. For MuxedEngine use only.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>decrypted data or null on failure</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../net/i2p/data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.9.46</dd>
</dl>
</li>
</ul>
<a name="decryptAESBlock-byte:A-int-int-net.i2p.data.SessionKey-byte:A-byte:A-java.util.Set-net.i2p.data.SessionKey-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decryptAESBlock</h4>
<pre>byte[]&nbsp;decryptAESBlock(byte[]&nbsp;encrypted,
                       int&nbsp;offset,
                       int&nbsp;encryptedLen,
                       <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
                       byte[]&nbsp;iv,
                       byte[]&nbsp;sentTag,
                       <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;foundTags,
                       <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;foundKey)
                throws <a href="../../../../net/i2p/data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></pre>
<div class="block">private byte[] decryptAESBlock(byte encrypted[], SessionKey key, byte iv[], 
                           byte sentTag[], Set foundTags, SessionKey foundKey) throws DataFormatException {
        return decryptAESBlock(encrypted, 0, encrypted.length, key, iv, sentTag, foundTags, foundKey);
    }</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../net/i2p/data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
</dl>
</li>
</ul>
<a name="encrypt-byte:A-net.i2p.data.PublicKey-net.i2p.data.SessionKey-java.util.Set-net.i2p.data.SessionTag-net.i2p.data.SessionKey-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encrypt</h4>
<pre>public&nbsp;byte[]&nbsp;encrypt(byte[]&nbsp;data,
                      <a href="../../../../net/i2p/data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
                      <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
                      <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
                      <a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&nbsp;currentTag,
                      <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;newKey,
                      long&nbsp;paddedSize)</pre>
<div class="block">Encrypt the unencrypted data to the target.  The total size returned will be 
 no less than the paddedSize parameter, but may be more.  This method uses the 
 ElGamal+AES algorithm in the data structure spec.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>target</code> - public key to which the data should be encrypted, must be ELGAMAL_2048.
               May be null if key and currentTag are non-null.</dd>
<dd><code>key</code> - session key to use during encryption</dd>
<dd><code>tagsForDelivery</code> - session tags to be associated with the key (or newKey if specified), or null;
                        200 max enforced at receiver</dd>
<dd><code>currentTag</code> - sessionTag to use, or null if it should use ElG (i.e. new session)</dd>
<dd><code>newKey</code> - key to be delivered to the target, with which the tagsForDelivery should be associated, or null</dd>
<dd><code>paddedSize</code> - minimum size in bytes of the body after padding it (if less than the
          body's real size, no bytes are appended but the body is not truncated)</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - on bad target EncType

 Unused externally, only called by below (i.e. newKey is always null)</dd>
</dl>
</li>
</ul>
<a name="encrypt-byte:A-net.i2p.data.PublicKey-net.i2p.data.SessionKey-java.util.Set-net.i2p.data.SessionTag-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encrypt</h4>
<pre>public&nbsp;byte[]&nbsp;encrypt(byte[]&nbsp;data,
                      <a href="../../../../net/i2p/data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
                      <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
                      <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
                      <a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&nbsp;currentTag,
                      long&nbsp;paddedSize)</pre>
<div class="block">Encrypt the data to the target using the given key and deliver the specified tags
 No new session key
 This is the one called from GarlicMessageBuilder and is the primary entry point.

 Re: padded size: The AES block adds at least 39 bytes of overhead to the data, and
 that is included in the minimum size calculation.

 In the router, we always use garlic messages. A garlic message with a single
 clove and zero data is about 84 bytes, so that's 123 bytes minimum. So any paddingSize
 &lt;= 128 is a no-op as every message will be at least 128 bytes
 (Streaming, if used, adds more overhead).

 Outside the router, with a client using its own message format, the minimum size
 is 48, so any paddingSize &lt;= 48 is a no-op.

 Not included in the minimum is a 32-byte session tag for an existing session,
 or a 514-byte ElGamal block and several 32-byte session tags for a new session.
 So the returned encrypted data will be at least 32 bytes larger than paddedSize.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>target</code> - public key to which the data should be encrypted, must be ELGAMAL_2048.
               May be null if key and currentTag are non-null.</dd>
<dd><code>key</code> - session key to use during encryption</dd>
<dd><code>tagsForDelivery</code> - session tags to be associated with the key or null;
                        200 max enforced at receiver</dd>
<dd><code>currentTag</code> - sessionTag to use, or null if it should use ElG (i.e. new session)</dd>
<dd><code>paddedSize</code> - minimum size in bytes of the body after padding it (if less than the
          body's real size, no bytes are appended but the body is not truncated)</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - on bad target EncType</dd>
</dl>
</li>
</ul>
<a name="encrypt-byte:A-net.i2p.data.PublicKey-net.i2p.data.SessionKey-java.util.Set-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encrypt</h4>
<pre><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Deprecated.html?is-external=true" title="class or interface in java.lang">@Deprecated</a>
public&nbsp;byte[]&nbsp;encrypt(byte[]&nbsp;data,
                                  <a href="../../../../net/i2p/data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
                                  <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
                                  <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
                                  long&nbsp;paddedSize)</pre>
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;<span class="deprecationComment">unused</span></div>
<div class="block">Encrypt the data to the target using the given key and deliver the specified tags
 No new session key
 No current tag (encrypt as new session)</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tagsForDelivery</code> - session tags to be associated with the key or null;
                        200 max enforced at receiver</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - on bad target EncType</dd>
</dl>
</li>
</ul>
<a name="encrypt-byte:A-net.i2p.data.PublicKey-net.i2p.data.SessionKey-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encrypt</h4>
<pre><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Deprecated.html?is-external=true" title="class or interface in java.lang">@Deprecated</a>
public&nbsp;byte[]&nbsp;encrypt(byte[]&nbsp;data,
                                  <a href="../../../../net/i2p/data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
                                  <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
                                  long&nbsp;paddedSize)</pre>
<div class="block"><span class="deprecatedLabel">Deprecated.</span>&nbsp;<span class="deprecationComment">unused</span></div>
<div class="block">Encrypt the data to the target using the given key delivering no tags
 No new session key
 No current tag (encrypt as new session)</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - on bad target EncType</dd>
</dl>
</li>
</ul>
<a name="encryptAESBlock-byte:A-net.i2p.data.SessionKey-byte:A-java.util.Set-net.i2p.data.SessionKey-long-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>encryptAESBlock</h4>
<pre>final&nbsp;byte[]&nbsp;encryptAESBlock(byte[]&nbsp;data,
                             <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
                             byte[]&nbsp;iv,
                             <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="../../../../net/i2p/data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
                             <a href="../../../../net/i2p/data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;newKey,
                             long&nbsp;paddedSize)</pre>
<div class="block">For both scenarios, this method encrypts the AES area using the given key, iv
 and making sure the resulting data is at least as long as the paddedSize and 
 also mod 16 bytes.  The contents of the encrypted data is:
 <pre>
  - 2 byte integer specifying the # of session tags
  - that many 32 byte session tags
  - 4 byte integer specifying data.length
  - SHA256 of data
  - 1 byte flag that, if == 1, is followed by a new SessionKey
  - data
  - random bytes, padding the total size to greater than paddedSize with a mod 16 = 0
 </pre>

 Note: package private for ElGamalTest.testAES()</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tagsForDelivery</code> - session tags to be associated with the key or null;
                        200 max enforced at receiver</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ElGamalAESEngine.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../net/i2p/router/crypto/FamilyKeyCrypto.html" title="class in net.i2p.router.crypto"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?net/i2p/router/crypto/ElGamalAESEngine.html" target="_top">Frames</a></li>
<li><a href="ElGamalAESEngine.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
