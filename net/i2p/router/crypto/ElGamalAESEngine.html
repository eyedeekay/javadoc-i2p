<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (19) -->
<title>ElGamalAESEngine (I2P Anonymous Network - Java Documentation - API Version 0.9.56)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: net.i2p.router.crypto, class: ElGamalAESEngine">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/ElGamalAESEngine.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li><a href="#field-summary">Field</a></li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li><a href="#field-detail">Field</a></li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">net.i2p.router.crypto</a></div>
<h1 title="Class ElGamalAESEngine" class="title">Class ElGamalAESEngine</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">net.i2p.router.crypto.ElGamalAESEngine</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public final class </span><span class="element-name type-name-label">ElGamalAESEngine</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Handles the actual ElGamal+AES encryption and decryption scenarios using the
 supplied keys and data.

 No, this does not extend AESEngine or CryptixAESEngine.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>0.9.38 moved from net.i2p.crypto</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static final int</code></div>
<div class="col-second even-row-color"><code><a href="#MAX_TAGS_RECEIVED" class="member-name-link">MAX_TAGS_RECEIVED</a></code></div>
<div class="col-last even-row-color">
<div class="block">enforced since release 0.6</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(net.i2p.I2PAppContext)" class="member-name-link">ElGamalAESEngine</a><wbr>(<a href="../../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx)</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button><button id="method-summary-table-tab6" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab6', 3)" class="table-tab">Deprecated Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6"><code>byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6"><code><a href="#decrypt(byte%5B%5D,net.i2p.data.PrivateKey)" class="member-name-link">decrypt</a><wbr>(byte[]&nbsp;data,
 <a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6">
<div class="block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">specify the key manager!</div>
</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#decrypt(byte%5B%5D,net.i2p.data.PrivateKey,net.i2p.crypto.SessionKeyManager)" class="member-name-link">decrypt</a><wbr>(byte[]&nbsp;data,
 <a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
 <a href="../../crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Decrypt the message using the given private key
 and using tags from the specified key manager.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>(package private) byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#decryptAESBlock(byte%5B%5D,int,int,net.i2p.data.SessionKey,byte%5B%5D,byte%5B%5D,java.util.Set,net.i2p.data.SessionKey)" class="member-name-link">decryptAESBlock</a><wbr>(byte[]&nbsp;encrypted,
 int&nbsp;offset,
 int&nbsp;encryptedLen,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
 byte[]&nbsp;iv,
 byte[]&nbsp;sentTag,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;foundTags,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;foundKey)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">private byte[] decryptAESBlock(byte encrypted[], SessionKey key, byte iv[], 
                           byte sentTag[], Set foundTags, SessionKey foundKey) throws DataFormatException {
        return decryptAESBlock(encrypted, 0, encrypted.length, key, iv, sentTag, foundTags, foundKey);
    }</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#decryptFast(byte%5B%5D,net.i2p.data.PrivateKey,net.i2p.crypto.SessionKeyManager)" class="member-name-link">decryptFast</a><wbr>(byte[]&nbsp;data,
 <a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
 <a href="../../crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Tags only.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#decryptSlow(byte%5B%5D,net.i2p.data.PrivateKey,net.i2p.crypto.SessionKeyManager)" class="member-name-link">decryptSlow</a><wbr>(byte[]&nbsp;data,
 <a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
 <a href="../../crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Full ElG only.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6"><code>byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6"><code><a href="#encrypt(byte%5B%5D,net.i2p.data.PublicKey,net.i2p.data.SessionKey,long)" class="member-name-link">encrypt</a><wbr>(byte[]&nbsp;data,
 <a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
 long&nbsp;paddedSize)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6">
<div class="block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">unused</div>
</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6"><code>byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6"><code><a href="#encrypt(byte%5B%5D,net.i2p.data.PublicKey,net.i2p.data.SessionKey,java.util.Set,long)" class="member-name-link">encrypt</a><wbr>(byte[]&nbsp;data,
 <a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
 long&nbsp;paddedSize)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6">
<div class="block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">unused</div>
</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#encrypt(byte%5B%5D,net.i2p.data.PublicKey,net.i2p.data.SessionKey,java.util.Set,net.i2p.data.SessionTag,long)" class="member-name-link">encrypt</a><wbr>(byte[]&nbsp;data,
 <a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
 <a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&nbsp;currentTag,
 long&nbsp;paddedSize)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Encrypt the data to the target using the given key and deliver the specified tags
 No new session key
 This is the one called from GarlicMessageBuilder and is the primary entry point.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#encrypt(byte%5B%5D,net.i2p.data.PublicKey,net.i2p.data.SessionKey,java.util.Set,net.i2p.data.SessionTag,net.i2p.data.SessionKey,long)" class="member-name-link">encrypt</a><wbr>(byte[]&nbsp;data,
 <a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
 <a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&nbsp;currentTag,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;newKey,
 long&nbsp;paddedSize)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Encrypt the unencrypted data to the target.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>(package private) final byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#encryptAESBlock(byte%5B%5D,net.i2p.data.SessionKey,byte%5B%5D,java.util.Set,net.i2p.data.SessionKey,long)" class="member-name-link">encryptAESBlock</a><wbr>(byte[]&nbsp;data,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
 byte[]&nbsp;iv,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;newKey,
 long&nbsp;paddedSize)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">For both scenarios, this method encrypts the AES area using the given key, iv
 and making sure the resulting data is at least as long as the paddedSize and 
 also mod 16 bytes.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="MAX_TAGS_RECEIVED">
<h3>MAX_TAGS_RECEIVED</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">MAX_TAGS_RECEIVED</span></div>
<div class="block">enforced since release 0.6</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="../../../../constant-values.html#net.i2p.router.crypto.ElGamalAESEngine.MAX_TAGS_RECEIVED">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(net.i2p.I2PAppContext)">
<h3>ElGamalAESEngine</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">ElGamalAESEngine</span><wbr><span class="parameters">(<a href="../../I2PAppContext.html" title="class in net.i2p">I2PAppContext</a>&nbsp;ctx)</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="decrypt(byte[],net.i2p.data.PrivateKey)">
<h3>decrypt</h3>
<div class="member-signature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Deprecated.html" title="class or interface in java.lang" class="external-link">@Deprecated</a>
</span><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">decrypt</span><wbr><span class="parameters">(byte[]&nbsp;data,
 <a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey)</span>
               throws <span class="exceptions"><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></span></div>
<div class="deprecation-block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">specify the key manager!</div>
</div>
<div class="block">Decrypt the message using the given private key using tags from the default key manager,
 which is the router's key manager. Use extreme care if you aren't the router.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="decrypt(byte[],net.i2p.data.PrivateKey,net.i2p.crypto.SessionKeyManager)">
<h3>decrypt</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">decrypt</span><wbr><span class="parameters">(byte[]&nbsp;data,
 <a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
 <a href="../../crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</span>
               throws <span class="exceptions"><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></span></div>
<div class="block">Decrypt the message using the given private key
 and using tags from the specified key manager.
 This works according to the
 ElGamal+AES algorithm in the data structure spec.

 Warning - use the correct SessionKeyManager. Clients should instantiate their own.
 Clients using I2PAppContext.sessionKeyManager() may be correlated with the router,
 unless you are careful to use different keys.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>decrypted data or null on failure</dd>
<dt>Throws:</dt>
<dd><code><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="decryptFast(byte[],net.i2p.data.PrivateKey,net.i2p.crypto.SessionKeyManager)">
<h3>decryptFast</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">decryptFast</span><wbr><span class="parameters">(byte[]&nbsp;data,
 <a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
 <a href="../../crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</span>
                   throws <span class="exceptions"><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></span></div>
<div class="block">Tags only. For MuxedEngine use only.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>decrypted data or null on failure</dd>
<dt>Throws:</dt>
<dd><code><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
<dt>Since:</dt>
<dd>0.9.46</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="decryptSlow(byte[],net.i2p.data.PrivateKey,net.i2p.crypto.SessionKeyManager)">
<h3>decryptSlow</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">decryptSlow</span><wbr><span class="parameters">(byte[]&nbsp;data,
 <a href="../../data/PrivateKey.html" title="class in net.i2p.data">PrivateKey</a>&nbsp;targetPrivateKey,
 <a href="../../crypto/SessionKeyManager.html" title="class in net.i2p.crypto">SessionKeyManager</a>&nbsp;keyManager)</span>
                   throws <span class="exceptions"><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></span></div>
<div class="block">Full ElG only. For MuxedEngine use only.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>decrypted data or null on failure</dd>
<dt>Throws:</dt>
<dd><code><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
<dt>Since:</dt>
<dd>0.9.46</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="decryptAESBlock(byte[],int,int,net.i2p.data.SessionKey,byte[],byte[],java.util.Set,net.i2p.data.SessionKey)">
<h3>decryptAESBlock</h3>
<div class="member-signature"><span class="return-type">byte[]</span>&nbsp;<span class="element-name">decryptAESBlock</span><wbr><span class="parameters">(byte[]&nbsp;encrypted,
 int&nbsp;offset,
 int&nbsp;encryptedLen,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
 byte[]&nbsp;iv,
 byte[]&nbsp;sentTag,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;foundTags,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;foundKey)</span>
                throws <span class="exceptions"><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></span></div>
<div class="block">private byte[] decryptAESBlock(byte encrypted[], SessionKey key, byte iv[], 
                           byte sentTag[], Set foundTags, SessionKey foundKey) throws DataFormatException {
        return decryptAESBlock(encrypted, 0, encrypted.length, key, iv, sentTag, foundTags, foundKey);
    }</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="../../data/DataFormatException.html" title="class in net.i2p.data">DataFormatException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="encrypt(byte[],net.i2p.data.PublicKey,net.i2p.data.SessionKey,java.util.Set,net.i2p.data.SessionTag,net.i2p.data.SessionKey,long)">
<h3>encrypt</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">encrypt</span><wbr><span class="parameters">(byte[]&nbsp;data,
 <a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
 <a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&nbsp;currentTag,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;newKey,
 long&nbsp;paddedSize)</span></div>
<div class="block">Encrypt the unencrypted data to the target.  The total size returned will be 
 no less than the paddedSize parameter, but may be more.  This method uses the 
 ElGamal+AES algorithm in the data structure spec.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>target</code> - public key to which the data should be encrypted, must be ELGAMAL_2048.
               May be null if key and currentTag are non-null.</dd>
<dd><code>key</code> - session key to use during encryption</dd>
<dd><code>tagsForDelivery</code> - session tags to be associated with the key (or newKey if specified), or null;
                        200 max enforced at receiver</dd>
<dd><code>currentTag</code> - sessionTag to use, or null if it should use ElG (i.e. new session)</dd>
<dd><code>newKey</code> - key to be delivered to the target, with which the tagsForDelivery should be associated, or null</dd>
<dd><code>paddedSize</code> - minimum size in bytes of the body after padding it (if less than the
          body's real size, no bytes are appended but the body is not truncated)</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - on bad target EncType

 Unused externally, only called by below (i.e. newKey is always null)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="encrypt(byte[],net.i2p.data.PublicKey,net.i2p.data.SessionKey,java.util.Set,net.i2p.data.SessionTag,long)">
<h3>encrypt</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">encrypt</span><wbr><span class="parameters">(byte[]&nbsp;data,
 <a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
 <a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&nbsp;currentTag,
 long&nbsp;paddedSize)</span></div>
<div class="block">Encrypt the data to the target using the given key and deliver the specified tags
 No new session key
 This is the one called from GarlicMessageBuilder and is the primary entry point.

 Re: padded size: The AES block adds at least 39 bytes of overhead to the data, and
 that is included in the minimum size calculation.

 In the router, we always use garlic messages. A garlic message with a single
 clove and zero data is about 84 bytes, so that's 123 bytes minimum. So any paddingSize
 &lt;= 128 is a no-op as every message will be at least 128 bytes
 (Streaming, if used, adds more overhead).

 Outside the router, with a client using its own message format, the minimum size
 is 48, so any paddingSize &lt;= 48 is a no-op.

 Not included in the minimum is a 32-byte session tag for an existing session,
 or a 514-byte ElGamal block and several 32-byte session tags for a new session.
 So the returned encrypted data will be at least 32 bytes larger than paddedSize.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>target</code> - public key to which the data should be encrypted, must be ELGAMAL_2048.
               May be null if key and currentTag are non-null.</dd>
<dd><code>key</code> - session key to use during encryption</dd>
<dd><code>tagsForDelivery</code> - session tags to be associated with the key or null;
                        200 max enforced at receiver</dd>
<dd><code>currentTag</code> - sessionTag to use, or null if it should use ElG (i.e. new session)</dd>
<dd><code>paddedSize</code> - minimum size in bytes of the body after padding it (if less than the
          body's real size, no bytes are appended but the body is not truncated)</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - on bad target EncType</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="encrypt(byte[],net.i2p.data.PublicKey,net.i2p.data.SessionKey,java.util.Set,long)">
<h3>encrypt</h3>
<div class="member-signature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Deprecated.html" title="class or interface in java.lang" class="external-link">@Deprecated</a>
</span><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">encrypt</span><wbr><span class="parameters">(byte[]&nbsp;data,
 <a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
 long&nbsp;paddedSize)</span></div>
<div class="deprecation-block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">unused</div>
</div>
<div class="block">Encrypt the data to the target using the given key and deliver the specified tags
 No new session key
 No current tag (encrypt as new session)</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>tagsForDelivery</code> - session tags to be associated with the key or null;
                        200 max enforced at receiver</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - on bad target EncType</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="encrypt(byte[],net.i2p.data.PublicKey,net.i2p.data.SessionKey,long)">
<h3>encrypt</h3>
<div class="member-signature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Deprecated.html" title="class or interface in java.lang" class="external-link">@Deprecated</a>
</span><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">encrypt</span><wbr><span class="parameters">(byte[]&nbsp;data,
 <a href="../../data/PublicKey.html" title="class in net.i2p.data">PublicKey</a>&nbsp;target,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
 long&nbsp;paddedSize)</span></div>
<div class="deprecation-block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">unused</div>
</div>
<div class="block">Encrypt the data to the target using the given key delivering no tags
 No new session key
 No current tag (encrypt as new session)</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - on bad target EncType</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="encryptAESBlock(byte[],net.i2p.data.SessionKey,byte[],java.util.Set,net.i2p.data.SessionKey,long)">
<h3>encryptAESBlock</h3>
<div class="member-signature"><span class="modifiers">final</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">encryptAESBlock</span><wbr><span class="parameters">(byte[]&nbsp;data,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;key,
 byte[]&nbsp;iv,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../data/SessionTag.html" title="class in net.i2p.data">SessionTag</a>&gt;&nbsp;tagsForDelivery,
 <a href="../../data/SessionKey.html" title="class in net.i2p.data">SessionKey</a>&nbsp;newKey,
 long&nbsp;paddedSize)</span></div>
<div class="block">For both scenarios, this method encrypts the AES area using the given key, iv
 and making sure the resulting data is at least as long as the paddedSize and 
 also mod 16 bytes.  The contents of the encrypted data is:
 <pre>
  - 2 byte integer specifying the # of session tags
  - that many 32 byte session tags
  - 4 byte integer specifying data.length
  - SHA256 of data
  - 1 byte flag that, if == 1, is followed by a new SessionKey
  - data
  - random bytes, padding the total size to greater than paddedSize with a mod 16 = 0
 </pre>

 Note: package private for ElGamalTest.testAES()</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>tagsForDelivery</code> - session tags to be associated with the key or null;
                        200 max enforced at receiver</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
